-module(mungo@client).
-compile([no_auto_import, nowarn_unused_vars, nowarn_unused_function, nowarn_nomatch]).

-export([collection/2, start/2]).
-export_type([message/0, connection/0, client/0, collection/0]).

-type message() :: shutdown |
    {get_timeout, gleam@erlang@process:subject(integer())} |
    {command,
        list({binary(), bison@bson:value()}),
        gleam@erlang@process:subject({ok,
                gleam@dict:dict(binary(), bison@bson:value())} |
            {error, mungo@error:error()})}.

-opaque connection() :: {connection, mug:socket(), boolean()}.

-opaque client() :: {client, binary(), list(connection())}.

-type collection() :: {collection,
        binary(),
        gleam@erlang@process:subject(message())}.

-spec collection(gleam@erlang@process:subject(message()), binary()) -> collection().
collection(Client, Name) ->
    {collection, Name, Client}.

-spec send_cmd(
    mug:socket(),
    binary(),
    list({binary(), bison@bson:value()}),
    integer()
) -> {ok, gleam@dict:dict(binary(), bison@bson:value())} |
    {error, mungo@error:error()}.
send_cmd(Socket, Db, Cmd, Timeout) ->
    Encoded = begin
        _pipe = Cmd,
        _pipe@1 = gleam@list:key_set(_pipe, <<"$db"/utf8>>, {string, Db}),
        bison:encode_list(_pipe@1)
    end,
    Size = erlang:byte_size(Encoded) + 21,
    Packet = begin
        _pipe@2 = [<<Size:32/little, 0:32, 0:32, 2013:32/little, 0:32, 0>>,
            Encoded],
        gleam_stdlib:bit_array_concat(_pipe@2)
    end,
    _pipe@3 = mungo@tcp:execute(Socket, Packet, Timeout),
    _pipe@5 = gleam@result:map(
        _pipe@3,
        fun(Reply) ->
            <<_:168, Rest/bitstring>> = case Reply of
                <<_:168, _/bitstring>> -> Reply;
                _assert_fail ->
                    erlang:error(#{gleam_error => let_assert,
                                message => <<"Assertion pattern match failed"/utf8>>,
                                value => _assert_fail,
                                module => <<"mungo/client"/utf8>>,
                                function => <<"send_cmd"/utf8>>,
                                line => 291})
            end,
            _pipe@4 = bison:decode(Rest),
            gleam@result:replace_error(_pipe@4, structure_error)
        end
    ),
    _pipe@6 = gleam@result:map_error(
        _pipe@5,
        fun(Tcp_error) -> {tcp_error, Tcp_error} end
    ),
    gleam@result:flatten(_pipe@6).

-spec is_primary(mug:socket(), binary(), integer()) -> {ok, boolean()} |
    {error, mungo@error:error()}.
is_primary(Socket, Db, Timeout) ->
    _pipe = send_cmd(Socket, Db, [{<<"hello"/utf8>>, {int32, 1}}], Timeout),
    gleam@result:map(
        _pipe,
        fun(Reply) ->
            case gleam@dict:get(Reply, <<"isWritablePrimary"/utf8>>) of
                {ok, {boolean, true}} ->
                    true;

                _ ->
                    false
            end
        end
    ).

-spec execute(client(), list({binary(), bison@bson:value()}), integer()) -> {ok,
        {gleam@dict:dict(binary(), bison@bson:value()), client()}} |
    {error, mungo@error:error()}.
execute(Client, Cmd, Timeout) ->
    case Client of
        {client, Name, Connections} ->
            _assert_subject = gleam@list:find(
                Connections,
                fun(Connection) -> erlang:element(3, Connection) end
            ),
            {ok, {connection, Socket, true}} = case _assert_subject of
                {ok, {connection, _, true}} -> _assert_subject;
                _assert_fail ->
                    erlang:error(#{gleam_error => let_assert,
                                message => <<"Assertion pattern match failed"/utf8>>,
                                value => _assert_fail,
                                module => <<"mungo/client"/utf8>>,
                                function => <<"execute"/utf8>>,
                                line => 130})
            end,
            case send_cmd(Socket, Name, Cmd, Timeout) of
                {ok, Reply} ->
                    case {gleam@dict:get(Reply, <<"ok"/utf8>>),
                        gleam@dict:get(Reply, <<"errmsg"/utf8>>),
                        gleam@dict:get(Reply, <<"code"/utf8>>)} of
                        {{ok, {double, +0.0}},
                            {ok, {string, Msg}},
                            {ok, {int32, Code}}} ->
                            _assert_subject@1 = gleam@list:key_find(
                                [{0, fun(Field@0) -> {ok, Field@0} end},
                                    {1,
                                        fun(Field@0) -> {internal_error, Field@0} end},
                                    {2,
                                        fun(Field@0) -> {bad_value, Field@0} end},
                                    {4,
                                        fun(Field@0) -> {no_such_key, Field@0} end},
                                    {5,
                                        fun(Field@0) -> {graph_contains_cycle, Field@0} end},
                                    {6,
                                        fun(Field@0) -> {host_unreachable, Field@0} end},
                                    {7,
                                        fun(Field@0) -> {host_not_found, Field@0} end},
                                    {8,
                                        fun(Field@0) -> {unknown_error, Field@0} end},
                                    {9,
                                        fun(Field@0) -> {failed_to_parse, Field@0} end},
                                    {10,
                                        fun(Field@0) -> {cannot_mutate_object, Field@0} end},
                                    {11,
                                        fun(Field@0) -> {user_not_found, Field@0} end},
                                    {12,
                                        fun(Field@0) -> {unsupported_format, Field@0} end},
                                    {13,
                                        fun(Field@0) -> {unauthorized, Field@0} end},
                                    {14,
                                        fun(Field@0) -> {type_mismatch, Field@0} end},
                                    {15,
                                        fun(Field@0) -> {overflow, Field@0} end},
                                    {16,
                                        fun(Field@0) -> {invalid_length, Field@0} end},
                                    {17,
                                        fun(Field@0) -> {protocol_error, Field@0} end},
                                    {18,
                                        fun(Field@0) -> {authentication_failed, Field@0} end},
                                    {19,
                                        fun(Field@0) -> {cannot_reuse_object, Field@0} end},
                                    {20,
                                        fun(Field@0) -> {illegal_operation, Field@0} end},
                                    {21,
                                        fun(Field@0) -> {empty_array_operation, Field@0} end},
                                    {22,
                                        fun(Field@0) -> {invalid_bson, Field@0} end},
                                    {23,
                                        fun(Field@0) -> {already_initialized, Field@0} end},
                                    {24,
                                        fun(Field@0) -> {lock_timeout, Field@0} end},
                                    {25,
                                        fun(Field@0) -> {remote_validation_error, Field@0} end},
                                    {26,
                                        fun(Field@0) -> {namespace_not_found, Field@0} end},
                                    {27,
                                        fun(Field@0) -> {index_not_found, Field@0} end},
                                    {28,
                                        fun(Field@0) -> {path_not_viable, Field@0} end},
                                    {29,
                                        fun(Field@0) -> {non_existent_path, Field@0} end},
                                    {30,
                                        fun(Field@0) -> {invalid_path, Field@0} end},
                                    {31,
                                        fun(Field@0) -> {role_not_found, Field@0} end},
                                    {32,
                                        fun(Field@0) -> {roles_not_related, Field@0} end},
                                    {33,
                                        fun(Field@0) -> {privilege_not_found, Field@0} end},
                                    {34,
                                        fun(Field@0) -> {cannot_backfill_array, Field@0} end},
                                    {35,
                                        fun(Field@0) -> {user_modification_failed, Field@0} end},
                                    {36,
                                        fun(Field@0) -> {remote_change_detected, Field@0} end},
                                    {37,
                                        fun(Field@0) -> {file_rename_failed, Field@0} end},
                                    {38,
                                        fun(Field@0) -> {file_not_open, Field@0} end},
                                    {39,
                                        fun(Field@0) -> {file_stream_failed, Field@0} end},
                                    {40,
                                        fun(Field@0) -> {conflicting_update_operators, Field@0} end},
                                    {41,
                                        fun(Field@0) -> {file_already_open, Field@0} end},
                                    {42,
                                        fun(Field@0) -> {log_write_failed, Field@0} end},
                                    {43,
                                        fun(Field@0) -> {cursor_not_found, Field@0} end},
                                    {45,
                                        fun(Field@0) -> {user_data_inconsistent, Field@0} end},
                                    {46,
                                        fun(Field@0) -> {lock_busy, Field@0} end},
                                    {47,
                                        fun(Field@0) -> {no_matching_document, Field@0} end},
                                    {48,
                                        fun(Field@0) -> {namespace_exists, Field@0} end},
                                    {49,
                                        fun(Field@0) -> {invalid_role_modification, Field@0} end},
                                    {50,
                                        fun(Field@0) -> {max_time_ms_expired, Field@0} end},
                                    {51,
                                        fun(Field@0) -> {manual_intervention_required, Field@0} end},
                                    {52,
                                        fun(Field@0) -> {dollar_prefixed_field_name, Field@0} end},
                                    {53,
                                        fun(Field@0) -> {invalid_id_field, Field@0} end},
                                    {54,
                                        fun(Field@0) -> {not_single_value_field, Field@0} end},
                                    {55,
                                        fun(Field@0) -> {invalid_db_ref, Field@0} end},
                                    {56,
                                        fun(Field@0) -> {empty_field_name, Field@0} end},
                                    {57,
                                        fun(Field@0) -> {dotted_field_name, Field@0} end},
                                    {58,
                                        fun(Field@0) -> {role_modification_failed, Field@0} end},
                                    {59,
                                        fun(Field@0) -> {command_not_found, Field@0} end},
                                    {61,
                                        fun(Field@0) -> {shard_key_not_found, Field@0} end},
                                    {62,
                                        fun(Field@0) -> {oplog_operation_unsupported, Field@0} end},
                                    {63,
                                        fun(Field@0) -> {stale_shard_version, Field@0} end},
                                    {64,
                                        fun(Field@0) -> {write_concern_failed, Field@0} end},
                                    {65,
                                        fun(Field@0) -> {multiple_errors_occurred, Field@0} end},
                                    {66,
                                        fun(Field@0) -> {immutable_field, Field@0} end},
                                    {67,
                                        fun(Field@0) -> {cannot_create_index, Field@0} end},
                                    {68,
                                        fun(Field@0) -> {index_already_exists, Field@0} end},
                                    {69,
                                        fun(Field@0) -> {auth_schema_incompatible, Field@0} end},
                                    {70,
                                        fun(Field@0) -> {shard_not_found, Field@0} end},
                                    {71,
                                        fun(Field@0) -> {replica_set_not_found, Field@0} end},
                                    {72,
                                        fun(Field@0) -> {invalid_options, Field@0} end},
                                    {73,
                                        fun(Field@0) -> {invalid_namespace, Field@0} end},
                                    {74,
                                        fun(Field@0) -> {node_not_found, Field@0} end},
                                    {75,
                                        fun(Field@0) -> {write_concern_legacy_ok, Field@0} end},
                                    {76,
                                        fun(Field@0) -> {no_replication_enabled, Field@0} end},
                                    {77,
                                        fun(Field@0) -> {operation_incomplete, Field@0} end},
                                    {78,
                                        fun(Field@0) -> {command_result_schema_violation, Field@0} end},
                                    {79,
                                        fun(Field@0) -> {unknown_repl_write_concern, Field@0} end},
                                    {80,
                                        fun(Field@0) -> {role_data_inconsistent, Field@0} end},
                                    {81,
                                        fun(Field@0) -> {no_match_parse_context, Field@0} end},
                                    {82,
                                        fun(Field@0) -> {no_progress_made, Field@0} end},
                                    {83,
                                        fun(Field@0) -> {remote_results_unavailable, Field@0} end},
                                    {85,
                                        fun(Field@0) -> {index_options_conflict, Field@0} end},
                                    {86,
                                        fun(Field@0) -> {index_key_specs_conflict, Field@0} end},
                                    {87,
                                        fun(Field@0) -> {cannot_split, Field@0} end},
                                    {89,
                                        fun(Field@0) -> {network_timeout, Field@0} end},
                                    {90,
                                        fun(Field@0) -> {callback_canceled, Field@0} end},
                                    {91,
                                        fun(Field@0) -> {shutdown_in_progress, Field@0} end},
                                    {92,
                                        fun(Field@0) -> {secondary_ahead_of_primary, Field@0} end},
                                    {93,
                                        fun(Field@0) -> {invalid_replica_set_config, Field@0} end},
                                    {94,
                                        fun(Field@0) -> {not_yet_initialized, Field@0} end},
                                    {95,
                                        fun(Field@0) -> {not_secondary, Field@0} end},
                                    {96,
                                        fun(Field@0) -> {operation_failed, Field@0} end},
                                    {97,
                                        fun(Field@0) -> {no_projection_found, Field@0} end},
                                    {98,
                                        fun(Field@0) -> {db_path_in_use, Field@0} end},
                                    {100,
                                        fun(Field@0) -> {unsatisfiable_write_concern, Field@0} end},
                                    {101,
                                        fun(Field@0) -> {outdated_client, Field@0} end},
                                    {102,
                                        fun(Field@0) -> {incompatible_audit_metadata, Field@0} end},
                                    {103,
                                        fun(Field@0) -> {new_replica_set_configuration_incompatible, Field@0} end},
                                    {104,
                                        fun(Field@0) -> {node_not_electable, Field@0} end},
                                    {105,
                                        fun(Field@0) -> {incompatible_sharding_metadata, Field@0} end},
                                    {106,
                                        fun(Field@0) -> {distributed_clock_skewed, Field@0} end},
                                    {107,
                                        fun(Field@0) -> {lock_failed, Field@0} end},
                                    {108,
                                        fun(Field@0) -> {inconsistent_replica_set_names, Field@0} end},
                                    {109,
                                        fun(Field@0) -> {configuration_in_progress, Field@0} end},
                                    {110,
                                        fun(Field@0) -> {cannot_initialize_node_with_data, Field@0} end},
                                    {111,
                                        fun(Field@0) -> {not_exact_value_field, Field@0} end},
                                    {112,
                                        fun(Field@0) -> {write_conflict, Field@0} end},
                                    {113,
                                        fun(Field@0) -> {initial_sync_failure, Field@0} end},
                                    {114,
                                        fun(Field@0) -> {initial_sync_oplog_source_missing, Field@0} end},
                                    {115,
                                        fun(Field@0) -> {command_not_supported, Field@0} end},
                                    {116,
                                        fun(Field@0) -> {doc_too_large_for_capped, Field@0} end},
                                    {117,
                                        fun(Field@0) -> {conflicting_operation_in_progress, Field@0} end},
                                    {118,
                                        fun(Field@0) -> {namespace_not_sharded, Field@0} end},
                                    {119,
                                        fun(Field@0) -> {invalid_sync_source, Field@0} end},
                                    {120,
                                        fun(Field@0) -> {oplog_start_missing, Field@0} end},
                                    {121,
                                        fun(Field@0) -> {document_validation_failure, Field@0} end},
                                    {123,
                                        fun(Field@0) -> {not_a_replica_set, Field@0} end},
                                    {124,
                                        fun(Field@0) -> {incompatible_election_protocol, Field@0} end},
                                    {125,
                                        fun(Field@0) -> {command_failed, Field@0} end},
                                    {126,
                                        fun(Field@0) -> {rpc_protocol_negotiation_failed, Field@0} end},
                                    {127,
                                        fun(Field@0) -> {unrecoverable_rollback_error, Field@0} end},
                                    {128,
                                        fun(Field@0) -> {lock_not_found, Field@0} end},
                                    {129,
                                        fun(Field@0) -> {lock_state_change_failed, Field@0} end},
                                    {130,
                                        fun(Field@0) -> {symbol_not_found, Field@0} end},
                                    {133,
                                        fun(Field@0) -> {failed_to_satisfy_read_preference, Field@0} end},
                                    {134,
                                        fun(Field@0) -> {read_concern_majority_not_available_yet, Field@0} end},
                                    {135,
                                        fun(Field@0) -> {stale_term, Field@0} end},
                                    {136,
                                        fun(Field@0) -> {capped_position_lost, Field@0} end},
                                    {137,
                                        fun(Field@0) -> {incompatible_sharding_config_version, Field@0} end},
                                    {138,
                                        fun(Field@0) -> {remote_oplog_stale, Field@0} end},
                                    {139,
                                        fun(Field@0) -> {js_interpreter_failure, Field@0} end},
                                    {140,
                                        fun(Field@0) -> {invalid_ssl_configuration, Field@0} end},
                                    {141,
                                        fun(Field@0) -> {ssl_handshake_failed, Field@0} end},
                                    {142,
                                        fun(Field@0) -> {js_uncatchable_error, Field@0} end},
                                    {143,
                                        fun(Field@0) -> {cursor_in_use, Field@0} end},
                                    {144,
                                        fun(Field@0) -> {incompatible_catalog_manager, Field@0} end},
                                    {145,
                                        fun(Field@0) -> {pooled_connections_dropped, Field@0} end},
                                    {146,
                                        fun(Field@0) -> {exceeded_memory_limit, Field@0} end},
                                    {147,
                                        fun(Field@0) -> {z_lib_error, Field@0} end},
                                    {148,
                                        fun(Field@0) -> {read_concern_majority_not_enabled, Field@0} end},
                                    {149,
                                        fun(Field@0) -> {no_config_primary, Field@0} end},
                                    {150,
                                        fun(Field@0) -> {stale_epoch, Field@0} end},
                                    {151,
                                        fun(Field@0) -> {operation_cannot_be_batched, Field@0} end},
                                    {152,
                                        fun(Field@0) -> {oplog_out_of_order, Field@0} end},
                                    {153,
                                        fun(Field@0) -> {chunk_too_big, Field@0} end},
                                    {154,
                                        fun(Field@0) -> {inconsistent_shard_identity, Field@0} end},
                                    {155,
                                        fun(Field@0) -> {cannot_apply_oplog_while_primary, Field@0} end},
                                    {157,
                                        fun(Field@0) -> {can_repair_to_downgrade, Field@0} end},
                                    {158,
                                        fun(Field@0) -> {must_upgrade, Field@0} end},
                                    {159,
                                        fun(Field@0) -> {duration_overflow, Field@0} end},
                                    {160,
                                        fun(Field@0) -> {max_staleness_out_of_range, Field@0} end},
                                    {161,
                                        fun(Field@0) -> {incompatible_collation_version, Field@0} end},
                                    {162,
                                        fun(Field@0) -> {collection_is_empty, Field@0} end},
                                    {163,
                                        fun(Field@0) -> {zone_still_in_use, Field@0} end},
                                    {164,
                                        fun(Field@0) -> {initial_sync_active, Field@0} end},
                                    {165,
                                        fun(Field@0) -> {view_depth_limit_exceeded, Field@0} end},
                                    {166,
                                        fun(Field@0) -> {command_not_supported_on_view, Field@0} end},
                                    {167,
                                        fun(Field@0) -> {option_not_supported_on_view, Field@0} end},
                                    {168,
                                        fun(Field@0) -> {invalid_pipeline_operator, Field@0} end},
                                    {169,
                                        fun(Field@0) -> {command_on_sharded_view_not_supported_on_mongod, Field@0} end},
                                    {170,
                                        fun(Field@0) -> {too_many_matching_documents, Field@0} end},
                                    {171,
                                        fun(Field@0) -> {cannot_index_parallel_arrays, Field@0} end},
                                    {172,
                                        fun(Field@0) -> {transport_session_closed, Field@0} end},
                                    {173,
                                        fun(Field@0) -> {transport_session_not_found, Field@0} end},
                                    {174,
                                        fun(Field@0) -> {transport_session_unknown, Field@0} end},
                                    {175,
                                        fun(Field@0) -> {query_plan_killed, Field@0} end},
                                    {176,
                                        fun(Field@0) -> {file_open_failed, Field@0} end},
                                    {177,
                                        fun(Field@0) -> {zone_not_found, Field@0} end},
                                    {178,
                                        fun(Field@0) -> {range_overlap_conflict, Field@0} end},
                                    {179,
                                        fun(Field@0) -> {windows_pdh_error, Field@0} end},
                                    {180,
                                        fun(Field@0) -> {bad_perf_counter_path, Field@0} end},
                                    {181,
                                        fun(Field@0) -> {ambiguous_index_key_pattern, Field@0} end},
                                    {182,
                                        fun(Field@0) -> {invalid_view_definition, Field@0} end},
                                    {183,
                                        fun(Field@0) -> {client_metadata_missing_field, Field@0} end},
                                    {184,
                                        fun(Field@0) -> {client_metadata_app_name_too_large, Field@0} end},
                                    {185,
                                        fun(Field@0) -> {client_metadata_document_too_large, Field@0} end},
                                    {186,
                                        fun(Field@0) -> {client_metadata_cannot_be_mutated, Field@0} end},
                                    {187,
                                        fun(Field@0) -> {linearizable_read_concern_error, Field@0} end},
                                    {188,
                                        fun(Field@0) -> {incompatible_server_version, Field@0} end},
                                    {189,
                                        fun(Field@0) -> {primary_stepped_down, Field@0} end},
                                    {190,
                                        fun(Field@0) -> {master_slave_connection_failure, Field@0} end},
                                    {192,
                                        fun(Field@0) -> {fail_point_enabled, Field@0} end},
                                    {193,
                                        fun(Field@0) -> {no_sharding_enabled, Field@0} end},
                                    {194,
                                        fun(Field@0) -> {balancer_interrupted, Field@0} end},
                                    {195,
                                        fun(Field@0) -> {view_pipeline_max_size_exceeded, Field@0} end},
                                    {197,
                                        fun(Field@0) -> {invalid_index_specification_option, Field@0} end},
                                    {199,
                                        fun(Field@0) -> {replica_set_monitor_removed, Field@0} end},
                                    {200,
                                        fun(Field@0) -> {chunk_range_cleanup_pending, Field@0} end},
                                    {201,
                                        fun(Field@0) -> {cannot_build_index_keys, Field@0} end},
                                    {202,
                                        fun(Field@0) -> {network_interface_exceeded_time_limit, Field@0} end},
                                    {203,
                                        fun(Field@0) -> {sharding_state_not_initialized, Field@0} end},
                                    {204,
                                        fun(Field@0) -> {time_proof_mismatch, Field@0} end},
                                    {205,
                                        fun(Field@0) -> {cluster_time_fails_rate_limiter, Field@0} end},
                                    {206,
                                        fun(Field@0) -> {no_such_session, Field@0} end},
                                    {207,
                                        fun(Field@0) -> {invalid_uuid, Field@0} end},
                                    {208,
                                        fun(Field@0) -> {too_many_locks, Field@0} end},
                                    {209,
                                        fun(Field@0) -> {stale_cluster_time, Field@0} end},
                                    {210,
                                        fun(Field@0) -> {cannot_verify_and_sign_logical_time, Field@0} end},
                                    {211,
                                        fun(Field@0) -> {key_not_found, Field@0} end},
                                    {212,
                                        fun(Field@0) -> {incompatible_rollback_algorithm, Field@0} end},
                                    {213,
                                        fun(Field@0) -> {duplicate_session, Field@0} end},
                                    {214,
                                        fun(Field@0) -> {authentication_restriction_unmet, Field@0} end},
                                    {215,
                                        fun(Field@0) -> {database_drop_pending, Field@0} end},
                                    {216,
                                        fun(Field@0) -> {election_in_progress, Field@0} end},
                                    {217,
                                        fun(Field@0) -> {incomplete_transaction_history, Field@0} end},
                                    {218,
                                        fun(Field@0) -> {update_operation_failed, Field@0} end},
                                    {219,
                                        fun(Field@0) -> {ftdc_path_not_set, Field@0} end},
                                    {220,
                                        fun(Field@0) -> {ftdc_path_already_set, Field@0} end},
                                    {221,
                                        fun(Field@0) -> {index_modified, Field@0} end},
                                    {222,
                                        fun(Field@0) -> {close_change_stream, Field@0} end},
                                    {223,
                                        fun(Field@0) -> {illegal_op_msg_flag, Field@0} end},
                                    {224,
                                        fun(Field@0) -> {query_feature_not_allowed, Field@0} end},
                                    {225,
                                        fun(Field@0) -> {transaction_too_old, Field@0} end},
                                    {226,
                                        fun(Field@0) -> {atomicity_failure, Field@0} end},
                                    {227,
                                        fun(Field@0) -> {cannot_implicitly_create_collection, Field@0} end},
                                    {228,
                                        fun(Field@0) -> {session_transfer_incomplete, Field@0} end},
                                    {229,
                                        fun(Field@0) -> {must_downgrade, Field@0} end},
                                    {230,
                                        fun(Field@0) -> {dns_host_not_found, Field@0} end},
                                    {231,
                                        fun(Field@0) -> {dns_protocol_error, Field@0} end},
                                    {232,
                                        fun(Field@0) -> {max_sub_pipeline_depth_exceeded, Field@0} end},
                                    {233,
                                        fun(Field@0) -> {too_many_document_sequences, Field@0} end},
                                    {234,
                                        fun(Field@0) -> {retry_change_stream, Field@0} end},
                                    {235,
                                        fun(Field@0) -> {internal_error_not_supported, Field@0} end},
                                    {236,
                                        fun(Field@0) -> {for_testing_error_extra_info, Field@0} end},
                                    {237,
                                        fun(Field@0) -> {cursor_killed, Field@0} end},
                                    {238,
                                        fun(Field@0) -> {not_implemented, Field@0} end},
                                    {239,
                                        fun(Field@0) -> {snapshot_too_old, Field@0} end},
                                    {240,
                                        fun(Field@0) -> {dns_record_type_mismatch, Field@0} end},
                                    {241,
                                        fun(Field@0) -> {conversion_failure, Field@0} end},
                                    {242,
                                        fun(Field@0) -> {cannot_create_collection, Field@0} end},
                                    {243,
                                        fun(Field@0) -> {incompatible_with_upgraded_server, Field@0} end},
                                    {245,
                                        fun(Field@0) -> {broken_promise, Field@0} end},
                                    {246,
                                        fun(Field@0) -> {snapshot_unavailable, Field@0} end},
                                    {247,
                                        fun(Field@0) -> {producer_consumer_queue_batch_too_large, Field@0} end},
                                    {248,
                                        fun(Field@0) -> {producer_consumer_queue_end_closed, Field@0} end},
                                    {249,
                                        fun(Field@0) -> {stale_db_version, Field@0} end},
                                    {250,
                                        fun(Field@0) -> {stale_chunk_history, Field@0} end},
                                    {251,
                                        fun(Field@0) -> {no_such_transaction, Field@0} end},
                                    {252,
                                        fun(Field@0) -> {reentrancy_not_allowed, Field@0} end},
                                    {253,
                                        fun(Field@0) -> {free_mon_http_in_flight, Field@0} end},
                                    {254,
                                        fun(Field@0) -> {free_mon_http_temporary_failure, Field@0} end},
                                    {255,
                                        fun(Field@0) -> {free_mon_http_permanent_failure, Field@0} end},
                                    {256,
                                        fun(Field@0) -> {transaction_committed, Field@0} end},
                                    {257,
                                        fun(Field@0) -> {transaction_too_large, Field@0} end},
                                    {258,
                                        fun(Field@0) -> {unknown_feature_compatibility_version, Field@0} end},
                                    {259,
                                        fun(Field@0) -> {keyed_executor_retry, Field@0} end},
                                    {260,
                                        fun(Field@0) -> {invalid_resume_token, Field@0} end},
                                    {261,
                                        fun(Field@0) -> {too_many_logical_sessions, Field@0} end},
                                    {262,
                                        fun(Field@0) -> {exceeded_time_limit, Field@0} end},
                                    {263,
                                        fun(Field@0) -> {operation_not_supported_in_transaction, Field@0} end},
                                    {264,
                                        fun(Field@0) -> {too_many_files_open, Field@0} end},
                                    {265,
                                        fun(Field@0) -> {orphaned_range_clean_up_failed, Field@0} end},
                                    {266,
                                        fun(Field@0) -> {fail_point_set_failed, Field@0} end},
                                    {267,
                                        fun(Field@0) -> {prepared_transaction_in_progress, Field@0} end},
                                    {268,
                                        fun(Field@0) -> {cannot_backup, Field@0} end},
                                    {269,
                                        fun(Field@0) -> {data_modified_by_repair, Field@0} end},
                                    {270,
                                        fun(Field@0) -> {repaired_replica_set_node, Field@0} end},
                                    {271,
                                        fun(Field@0) -> {js_interpreter_failure_with_stack, Field@0} end},
                                    {272,
                                        fun(Field@0) -> {migration_conflict, Field@0} end},
                                    {273,
                                        fun(Field@0) -> {producer_consumer_queue_producer_queue_depth_exceeded, Field@0} end},
                                    {274,
                                        fun(Field@0) -> {producer_consumer_queue_consumed, Field@0} end},
                                    {275,
                                        fun(Field@0) -> {exchange_passthrough, Field@0} end},
                                    {276,
                                        fun(Field@0) -> {index_build_aborted, Field@0} end},
                                    {277,
                                        fun(Field@0) -> {alarm_already_fulfilled, Field@0} end},
                                    {278,
                                        fun(Field@0) -> {unsatisfiable_commit_quorum, Field@0} end},
                                    {279,
                                        fun(Field@0) -> {client_disconnect, Field@0} end},
                                    {280,
                                        fun(Field@0) -> {change_stream_fatal_error, Field@0} end},
                                    {281,
                                        fun(Field@0) -> {transaction_coordinator_stepping_down, Field@0} end},
                                    {282,
                                        fun(Field@0) -> {transaction_coordinator_reached_abort_decision, Field@0} end},
                                    {283,
                                        fun(Field@0) -> {would_change_owning_shard, Field@0} end},
                                    {284,
                                        fun(Field@0) -> {for_testing_error_extra_info_with_extra_info_in_namespace, Field@0} end},
                                    {285,
                                        fun(Field@0) -> {index_build_already_in_progress, Field@0} end},
                                    {286,
                                        fun(Field@0) -> {change_stream_history_lost, Field@0} end},
                                    {287,
                                        fun(Field@0) -> {transaction_coordinator_deadline_task_canceled, Field@0} end},
                                    {288,
                                        fun(Field@0) -> {checksum_mismatch, Field@0} end},
                                    {289,
                                        fun(Field@0) -> {wait_for_majority_service_earlier_op_time_available, Field@0} end},
                                    {290,
                                        fun(Field@0) -> {transaction_exceeded_lifetime_limit_seconds, Field@0} end},
                                    {291,
                                        fun(Field@0) -> {no_query_execution_plans, Field@0} end},
                                    {292,
                                        fun(Field@0) -> {query_exceeded_memory_limit_no_disk_use_allowed, Field@0} end},
                                    {293,
                                        fun(Field@0) -> {invalid_seed_list, Field@0} end},
                                    {294,
                                        fun(Field@0) -> {invalid_topology_type, Field@0} end},
                                    {295,
                                        fun(Field@0) -> {invalid_heart_beat_frequency, Field@0} end},
                                    {296,
                                        fun(Field@0) -> {topology_set_name_required, Field@0} end},
                                    {297,
                                        fun(Field@0) -> {hierarchical_acquisition_level_violation, Field@0} end},
                                    {298,
                                        fun(Field@0) -> {invalid_server_type, Field@0} end},
                                    {299,
                                        fun(Field@0) -> {ocsp_certificate_status_revoked, Field@0} end},
                                    {300,
                                        fun(Field@0) -> {range_deletion_abandoned_because_collection_with_uuid_does_not_exist, Field@0} end},
                                    {301,
                                        fun(Field@0) -> {data_corruption_detected, Field@0} end},
                                    {302,
                                        fun(Field@0) -> {ocsp_certificate_status_unknown, Field@0} end},
                                    {303,
                                        fun(Field@0) -> {split_horizon_change, Field@0} end},
                                    {304,
                                        fun(Field@0) -> {shard_invalidated_for_targeting, Field@0} end},
                                    {306,
                                        fun(Field@0) -> {read_through_cache_lookup_canceled, Field@0} end},
                                    {307,
                                        fun(Field@0) -> {range_deletion_abandoned_because_task_document_does_not_exist, Field@0} end},
                                    {308,
                                        fun(Field@0) -> {current_config_not_committed_yet, Field@0} end},
                                    {309,
                                        fun(Field@0) -> {exhaust_command_finished, Field@0} end},
                                    {310,
                                        fun(Field@0) -> {periodic_job_is_stopped, Field@0} end},
                                    {311,
                                        fun(Field@0) -> {transaction_coordinator_canceled, Field@0} end},
                                    {312,
                                        fun(Field@0) -> {operation_is_killed_and_delisted, Field@0} end},
                                    {313,
                                        fun(Field@0) -> {resumable_range_deleter_disabled, Field@0} end},
                                    {314,
                                        fun(Field@0) -> {object_is_busy, Field@0} end},
                                    {315,
                                        fun(Field@0) -> {too_stale_to_sync_from_source, Field@0} end},
                                    {316,
                                        fun(Field@0) -> {query_trial_run_completed, Field@0} end},
                                    {317,
                                        fun(Field@0) -> {connection_pool_expired, Field@0} end},
                                    {318,
                                        fun(Field@0) -> {for_testing_optional_error_extra_info, Field@0} end},
                                    {319,
                                        fun(Field@0) -> {move_primary_in_progress, Field@0} end},
                                    {320,
                                        fun(Field@0) -> {tenant_migration_conflict, Field@0} end},
                                    {321,
                                        fun(Field@0) -> {tenant_migration_committed, Field@0} end},
                                    {322,
                                        fun(Field@0) -> {api_version_error, Field@0} end},
                                    {323,
                                        fun(Field@0) -> {api_strict_error, Field@0} end},
                                    {324,
                                        fun(Field@0) -> {api_deprecation_error, Field@0} end},
                                    {325,
                                        fun(Field@0) -> {tenant_migration_aborted, Field@0} end},
                                    {326,
                                        fun(Field@0) -> {oplog_query_min_ts_missing, Field@0} end},
                                    {327,
                                        fun(Field@0) -> {no_such_tenant_migration, Field@0} end},
                                    {328,
                                        fun(Field@0) -> {tenant_migration_access_blocker_shutting_down, Field@0} end},
                                    {329,
                                        fun(Field@0) -> {tenant_migration_in_progress, Field@0} end},
                                    {330,
                                        fun(Field@0) -> {skip_command_execution, Field@0} end},
                                    {331,
                                        fun(Field@0) -> {failed_to_run_with_reply_builder, Field@0} end},
                                    {332,
                                        fun(Field@0) -> {cannot_downgrade, Field@0} end},
                                    {333,
                                        fun(Field@0) -> {service_executor_in_shutdown, Field@0} end},
                                    {334,
                                        fun(Field@0) -> {mechanism_unavailable, Field@0} end},
                                    {335,
                                        fun(Field@0) -> {tenant_migration_forgotten, Field@0} end},
                                    {9001,
                                        fun(Field@0) -> {socket_exception, Field@0} end},
                                    {10003,
                                        fun(Field@0) -> {cannot_grow_document_in_capped_namespace, Field@0} end},
                                    {10107,
                                        fun(Field@0) -> {not_writable_primary, Field@0} end},
                                    {10334,
                                        fun(Field@0) -> {bson_object_too_large, Field@0} end},
                                    {11000,
                                        fun(Field@0) -> {duplicate_key, Field@0} end},
                                    {11600,
                                        fun(Field@0) -> {interrupted_at_shutdown, Field@0} end},
                                    {11601,
                                        fun(Field@0) -> {interrupted, Field@0} end},
                                    {11602,
                                        fun(Field@0) -> {interrupted_due_to_repl_state_change, Field@0} end},
                                    {12586,
                                        fun(Field@0) -> {background_operation_in_progress_for_database, Field@0} end},
                                    {12587,
                                        fun(Field@0) -> {background_operation_in_progress_for_namespace, Field@0} end},
                                    {13113,
                                        fun(Field@0) -> {merge_stage_no_matching_document, Field@0} end},
                                    {13297,
                                        fun(Field@0) -> {database_differ_case, Field@0} end},
                                    {13388,
                                        fun(Field@0) -> {stale_config, Field@0} end},
                                    {13435,
                                        fun(Field@0) -> {not_primary_no_secondary_ok, Field@0} end},
                                    {13436,
                                        fun(Field@0) -> {not_primary_or_secondary, Field@0} end},
                                    {14031,
                                        fun(Field@0) -> {out_of_disk_space, Field@0} end},
                                    {46841,
                                        fun(Field@0) -> {client_marked_killed, Field@0} end}],
                                Code
                            ),
                            {ok, Error} = case _assert_subject@1 of
                                {ok, _} -> _assert_subject@1;
                                _assert_fail@1 ->
                                    erlang:error(#{gleam_error => let_assert,
                                                message => <<"Assertion pattern match failed"/utf8>>,
                                                value => _assert_fail@1,
                                                module => <<"mungo/client"/utf8>>,
                                                function => <<"execute"/utf8>>,
                                                line => 141})
                            end,
                            Error@1 = Error(Msg),
                            case mungo@error:is_retriable_error(Error@1) of
                                true ->
                                    case mungo@error:is_not_primary_error(
                                        Error@1
                                    ) of
                                        true ->
                                            gleam@result:then(
                                                begin
                                                    _pipe = erlang:element(
                                                        3,
                                                        Client
                                                    ),
                                                    gleam@list:try_map(
                                                        _pipe,
                                                        fun(Connection@1) ->
                                                            gleam@result:then(
                                                                is_primary(
                                                                    erlang:element(
                                                                        2,
                                                                        Connection@1
                                                                    ),
                                                                    erlang:element(
                                                                        2,
                                                                        Client
                                                                    ),
                                                                    Timeout
                                                                ),
                                                                fun(Is_primary) ->
                                                                    {ok,
                                                                        {connection,
                                                                            Socket,
                                                                            Is_primary}}
                                                                end
                                                            )
                                                        end
                                                    )
                                                end,
                                                fun(Connections@1) ->
                                                    _assert_subject@2 = gleam@list:find(
                                                        Connections@1,
                                                        fun(Connection@2) ->
                                                            case is_primary(
                                                                erlang:element(
                                                                    2,
                                                                    Connection@2
                                                                ),
                                                                erlang:element(
                                                                    2,
                                                                    Client
                                                                ),
                                                                Timeout
                                                            ) of
                                                                {ok,
                                                                    Is_primary@1} ->
                                                                    Is_primary@1;

                                                                {error, _} ->
                                                                    false
                                                            end
                                                        end
                                                    ),
                                                    {ok,
                                                        {connection,
                                                            Socket@1,
                                                            true}} = case _assert_subject@2 of
                                                        {ok,
                                                            {connection,
                                                                _,
                                                                true}} -> _assert_subject@2;
                                                        _assert_fail@2 ->
                                                            erlang:error(
                                                                    #{gleam_error => let_assert,
                                                                        message => <<"Assertion pattern match failed"/utf8>>,
                                                                        value => _assert_fail@2,
                                                                        module => <<"mungo/client"/utf8>>,
                                                                        function => <<"execute"/utf8>>,
                                                                        line => 161}
                                                                )
                                                    end,
                                                    case send_cmd(
                                                        Socket@1,
                                                        Name,
                                                        Cmd,
                                                        Timeout
                                                    ) of
                                                        {ok, Reply@1} ->
                                                            case {gleam@dict:get(
                                                                    Reply@1,
                                                                    <<"ok"/utf8>>
                                                                ),
                                                                gleam@dict:get(
                                                                    Reply@1,
                                                                    <<"errmsg"/utf8>>
                                                                ),
                                                                gleam@dict:get(
                                                                    Reply@1,
                                                                    <<"code"/utf8>>
                                                                )} of
                                                                {{ok,
                                                                        {double,
                                                                            +0.0}},
                                                                    {ok,
                                                                        {string,
                                                                            Msg@1}},
                                                                    {ok,
                                                                        {int32,
                                                                            Code@1}}} ->
                                                                    _assert_subject@3 = gleam@list:key_find(
                                                                        [{0,
                                                                                fun(Field@0) -> {ok, Field@0} end},
                                                                            {1,
                                                                                fun(Field@0) -> {internal_error, Field@0} end},
                                                                            {2,
                                                                                fun(Field@0) -> {bad_value, Field@0} end},
                                                                            {4,
                                                                                fun(Field@0) -> {no_such_key, Field@0} end},
                                                                            {5,
                                                                                fun(Field@0) -> {graph_contains_cycle, Field@0} end},
                                                                            {6,
                                                                                fun(Field@0) -> {host_unreachable, Field@0} end},
                                                                            {7,
                                                                                fun(Field@0) -> {host_not_found, Field@0} end},
                                                                            {8,
                                                                                fun(Field@0) -> {unknown_error, Field@0} end},
                                                                            {9,
                                                                                fun(Field@0) -> {failed_to_parse, Field@0} end},
                                                                            {10,
                                                                                fun(Field@0) -> {cannot_mutate_object, Field@0} end},
                                                                            {11,
                                                                                fun(Field@0) -> {user_not_found, Field@0} end},
                                                                            {12,
                                                                                fun(Field@0) -> {unsupported_format, Field@0} end},
                                                                            {13,
                                                                                fun(Field@0) -> {unauthorized, Field@0} end},
                                                                            {14,
                                                                                fun(Field@0) -> {type_mismatch, Field@0} end},
                                                                            {15,
                                                                                fun(Field@0) -> {overflow, Field@0} end},
                                                                            {16,
                                                                                fun(Field@0) -> {invalid_length, Field@0} end},
                                                                            {17,
                                                                                fun(Field@0) -> {protocol_error, Field@0} end},
                                                                            {18,
                                                                                fun(Field@0) -> {authentication_failed, Field@0} end},
                                                                            {19,
                                                                                fun(Field@0) -> {cannot_reuse_object, Field@0} end},
                                                                            {20,
                                                                                fun(Field@0) -> {illegal_operation, Field@0} end},
                                                                            {21,
                                                                                fun(Field@0) -> {empty_array_operation, Field@0} end},
                                                                            {22,
                                                                                fun(Field@0) -> {invalid_bson, Field@0} end},
                                                                            {23,
                                                                                fun(Field@0) -> {already_initialized, Field@0} end},
                                                                            {24,
                                                                                fun(Field@0) -> {lock_timeout, Field@0} end},
                                                                            {25,
                                                                                fun(Field@0) -> {remote_validation_error, Field@0} end},
                                                                            {26,
                                                                                fun(Field@0) -> {namespace_not_found, Field@0} end},
                                                                            {27,
                                                                                fun(Field@0) -> {index_not_found, Field@0} end},
                                                                            {28,
                                                                                fun(Field@0) -> {path_not_viable, Field@0} end},
                                                                            {29,
                                                                                fun(Field@0) -> {non_existent_path, Field@0} end},
                                                                            {30,
                                                                                fun(Field@0) -> {invalid_path, Field@0} end},
                                                                            {31,
                                                                                fun(Field@0) -> {role_not_found, Field@0} end},
                                                                            {32,
                                                                                fun(Field@0) -> {roles_not_related, Field@0} end},
                                                                            {33,
                                                                                fun(Field@0) -> {privilege_not_found, Field@0} end},
                                                                            {34,
                                                                                fun(Field@0) -> {cannot_backfill_array, Field@0} end},
                                                                            {35,
                                                                                fun(Field@0) -> {user_modification_failed, Field@0} end},
                                                                            {36,
                                                                                fun(Field@0) -> {remote_change_detected, Field@0} end},
                                                                            {37,
                                                                                fun(Field@0) -> {file_rename_failed, Field@0} end},
                                                                            {38,
                                                                                fun(Field@0) -> {file_not_open, Field@0} end},
                                                                            {39,
                                                                                fun(Field@0) -> {file_stream_failed, Field@0} end},
                                                                            {40,
                                                                                fun(Field@0) -> {conflicting_update_operators, Field@0} end},
                                                                            {41,
                                                                                fun(Field@0) -> {file_already_open, Field@0} end},
                                                                            {42,
                                                                                fun(Field@0) -> {log_write_failed, Field@0} end},
                                                                            {43,
                                                                                fun(Field@0) -> {cursor_not_found, Field@0} end},
                                                                            {45,
                                                                                fun(Field@0) -> {user_data_inconsistent, Field@0} end},
                                                                            {46,
                                                                                fun(Field@0) -> {lock_busy, Field@0} end},
                                                                            {47,
                                                                                fun(Field@0) -> {no_matching_document, Field@0} end},
                                                                            {48,
                                                                                fun(Field@0) -> {namespace_exists, Field@0} end},
                                                                            {49,
                                                                                fun(Field@0) -> {invalid_role_modification, Field@0} end},
                                                                            {50,
                                                                                fun(Field@0) -> {max_time_ms_expired, Field@0} end},
                                                                            {51,
                                                                                fun(Field@0) -> {manual_intervention_required, Field@0} end},
                                                                            {52,
                                                                                fun(Field@0) -> {dollar_prefixed_field_name, Field@0} end},
                                                                            {53,
                                                                                fun(Field@0) -> {invalid_id_field, Field@0} end},
                                                                            {54,
                                                                                fun(Field@0) -> {not_single_value_field, Field@0} end},
                                                                            {55,
                                                                                fun(Field@0) -> {invalid_db_ref, Field@0} end},
                                                                            {56,
                                                                                fun(Field@0) -> {empty_field_name, Field@0} end},
                                                                            {57,
                                                                                fun(Field@0) -> {dotted_field_name, Field@0} end},
                                                                            {58,
                                                                                fun(Field@0) -> {role_modification_failed, Field@0} end},
                                                                            {59,
                                                                                fun(Field@0) -> {command_not_found, Field@0} end},
                                                                            {61,
                                                                                fun(Field@0) -> {shard_key_not_found, Field@0} end},
                                                                            {62,
                                                                                fun(Field@0) -> {oplog_operation_unsupported, Field@0} end},
                                                                            {63,
                                                                                fun(Field@0) -> {stale_shard_version, Field@0} end},
                                                                            {64,
                                                                                fun(Field@0) -> {write_concern_failed, Field@0} end},
                                                                            {65,
                                                                                fun(Field@0) -> {multiple_errors_occurred, Field@0} end},
                                                                            {66,
                                                                                fun(Field@0) -> {immutable_field, Field@0} end},
                                                                            {67,
                                                                                fun(Field@0) -> {cannot_create_index, Field@0} end},
                                                                            {68,
                                                                                fun(Field@0) -> {index_already_exists, Field@0} end},
                                                                            {69,
                                                                                fun(Field@0) -> {auth_schema_incompatible, Field@0} end},
                                                                            {70,
                                                                                fun(Field@0) -> {shard_not_found, Field@0} end},
                                                                            {71,
                                                                                fun(Field@0) -> {replica_set_not_found, Field@0} end},
                                                                            {72,
                                                                                fun(Field@0) -> {invalid_options, Field@0} end},
                                                                            {73,
                                                                                fun(Field@0) -> {invalid_namespace, Field@0} end},
                                                                            {74,
                                                                                fun(Field@0) -> {node_not_found, Field@0} end},
                                                                            {75,
                                                                                fun(Field@0) -> {write_concern_legacy_ok, Field@0} end},
                                                                            {76,
                                                                                fun(Field@0) -> {no_replication_enabled, Field@0} end},
                                                                            {77,
                                                                                fun(Field@0) -> {operation_incomplete, Field@0} end},
                                                                            {78,
                                                                                fun(Field@0) -> {command_result_schema_violation, Field@0} end},
                                                                            {79,
                                                                                fun(Field@0) -> {unknown_repl_write_concern, Field@0} end},
                                                                            {80,
                                                                                fun(Field@0) -> {role_data_inconsistent, Field@0} end},
                                                                            {81,
                                                                                fun(Field@0) -> {no_match_parse_context, Field@0} end},
                                                                            {82,
                                                                                fun(Field@0) -> {no_progress_made, Field@0} end},
                                                                            {83,
                                                                                fun(Field@0) -> {remote_results_unavailable, Field@0} end},
                                                                            {85,
                                                                                fun(Field@0) -> {index_options_conflict, Field@0} end},
                                                                            {86,
                                                                                fun(Field@0) -> {index_key_specs_conflict, Field@0} end},
                                                                            {87,
                                                                                fun(Field@0) -> {cannot_split, Field@0} end},
                                                                            {89,
                                                                                fun(Field@0) -> {network_timeout, Field@0} end},
                                                                            {90,
                                                                                fun(Field@0) -> {callback_canceled, Field@0} end},
                                                                            {91,
                                                                                fun(Field@0) -> {shutdown_in_progress, Field@0} end},
                                                                            {92,
                                                                                fun(Field@0) -> {secondary_ahead_of_primary, Field@0} end},
                                                                            {93,
                                                                                fun(Field@0) -> {invalid_replica_set_config, Field@0} end},
                                                                            {94,
                                                                                fun(Field@0) -> {not_yet_initialized, Field@0} end},
                                                                            {95,
                                                                                fun(Field@0) -> {not_secondary, Field@0} end},
                                                                            {96,
                                                                                fun(Field@0) -> {operation_failed, Field@0} end},
                                                                            {97,
                                                                                fun(Field@0) -> {no_projection_found, Field@0} end},
                                                                            {98,
                                                                                fun(Field@0) -> {db_path_in_use, Field@0} end},
                                                                            {100,
                                                                                fun(Field@0) -> {unsatisfiable_write_concern, Field@0} end},
                                                                            {101,
                                                                                fun(Field@0) -> {outdated_client, Field@0} end},
                                                                            {102,
                                                                                fun(Field@0) -> {incompatible_audit_metadata, Field@0} end},
                                                                            {103,
                                                                                fun(Field@0) -> {new_replica_set_configuration_incompatible, Field@0} end},
                                                                            {104,
                                                                                fun(Field@0) -> {node_not_electable, Field@0} end},
                                                                            {105,
                                                                                fun(Field@0) -> {incompatible_sharding_metadata, Field@0} end},
                                                                            {106,
                                                                                fun(Field@0) -> {distributed_clock_skewed, Field@0} end},
                                                                            {107,
                                                                                fun(Field@0) -> {lock_failed, Field@0} end},
                                                                            {108,
                                                                                fun(Field@0) -> {inconsistent_replica_set_names, Field@0} end},
                                                                            {109,
                                                                                fun(Field@0) -> {configuration_in_progress, Field@0} end},
                                                                            {110,
                                                                                fun(Field@0) -> {cannot_initialize_node_with_data, Field@0} end},
                                                                            {111,
                                                                                fun(Field@0) -> {not_exact_value_field, Field@0} end},
                                                                            {112,
                                                                                fun(Field@0) -> {write_conflict, Field@0} end},
                                                                            {113,
                                                                                fun(Field@0) -> {initial_sync_failure, Field@0} end},
                                                                            {114,
                                                                                fun(Field@0) -> {initial_sync_oplog_source_missing, Field@0} end},
                                                                            {115,
                                                                                fun(Field@0) -> {command_not_supported, Field@0} end},
                                                                            {116,
                                                                                fun(Field@0) -> {doc_too_large_for_capped, Field@0} end},
                                                                            {117,
                                                                                fun(Field@0) -> {conflicting_operation_in_progress, Field@0} end},
                                                                            {118,
                                                                                fun(Field@0) -> {namespace_not_sharded, Field@0} end},
                                                                            {119,
                                                                                fun(Field@0) -> {invalid_sync_source, Field@0} end},
                                                                            {120,
                                                                                fun(Field@0) -> {oplog_start_missing, Field@0} end},
                                                                            {121,
                                                                                fun(Field@0) -> {document_validation_failure, Field@0} end},
                                                                            {123,
                                                                                fun(Field@0) -> {not_a_replica_set, Field@0} end},
                                                                            {124,
                                                                                fun(Field@0) -> {incompatible_election_protocol, Field@0} end},
                                                                            {125,
                                                                                fun(Field@0) -> {command_failed, Field@0} end},
                                                                            {126,
                                                                                fun(Field@0) -> {rpc_protocol_negotiation_failed, Field@0} end},
                                                                            {127,
                                                                                fun(Field@0) -> {unrecoverable_rollback_error, Field@0} end},
                                                                            {128,
                                                                                fun(Field@0) -> {lock_not_found, Field@0} end},
                                                                            {129,
                                                                                fun(Field@0) -> {lock_state_change_failed, Field@0} end},
                                                                            {130,
                                                                                fun(Field@0) -> {symbol_not_found, Field@0} end},
                                                                            {133,
                                                                                fun(Field@0) -> {failed_to_satisfy_read_preference, Field@0} end},
                                                                            {134,
                                                                                fun(Field@0) -> {read_concern_majority_not_available_yet, Field@0} end},
                                                                            {135,
                                                                                fun(Field@0) -> {stale_term, Field@0} end},
                                                                            {136,
                                                                                fun(Field@0) -> {capped_position_lost, Field@0} end},
                                                                            {137,
                                                                                fun(Field@0) -> {incompatible_sharding_config_version, Field@0} end},
                                                                            {138,
                                                                                fun(Field@0) -> {remote_oplog_stale, Field@0} end},
                                                                            {139,
                                                                                fun(Field@0) -> {js_interpreter_failure, Field@0} end},
                                                                            {140,
                                                                                fun(Field@0) -> {invalid_ssl_configuration, Field@0} end},
                                                                            {141,
                                                                                fun(Field@0) -> {ssl_handshake_failed, Field@0} end},
                                                                            {142,
                                                                                fun(Field@0) -> {js_uncatchable_error, Field@0} end},
                                                                            {143,
                                                                                fun(Field@0) -> {cursor_in_use, Field@0} end},
                                                                            {144,
                                                                                fun(Field@0) -> {incompatible_catalog_manager, Field@0} end},
                                                                            {145,
                                                                                fun(Field@0) -> {pooled_connections_dropped, Field@0} end},
                                                                            {146,
                                                                                fun(Field@0) -> {exceeded_memory_limit, Field@0} end},
                                                                            {147,
                                                                                fun(Field@0) -> {z_lib_error, Field@0} end},
                                                                            {148,
                                                                                fun(Field@0) -> {read_concern_majority_not_enabled, Field@0} end},
                                                                            {149,
                                                                                fun(Field@0) -> {no_config_primary, Field@0} end},
                                                                            {150,
                                                                                fun(Field@0) -> {stale_epoch, Field@0} end},
                                                                            {151,
                                                                                fun(Field@0) -> {operation_cannot_be_batched, Field@0} end},
                                                                            {152,
                                                                                fun(Field@0) -> {oplog_out_of_order, Field@0} end},
                                                                            {153,
                                                                                fun(Field@0) -> {chunk_too_big, Field@0} end},
                                                                            {154,
                                                                                fun(Field@0) -> {inconsistent_shard_identity, Field@0} end},
                                                                            {155,
                                                                                fun(Field@0) -> {cannot_apply_oplog_while_primary, Field@0} end},
                                                                            {157,
                                                                                fun(Field@0) -> {can_repair_to_downgrade, Field@0} end},
                                                                            {158,
                                                                                fun(Field@0) -> {must_upgrade, Field@0} end},
                                                                            {159,
                                                                                fun(Field@0) -> {duration_overflow, Field@0} end},
                                                                            {160,
                                                                                fun(Field@0) -> {max_staleness_out_of_range, Field@0} end},
                                                                            {161,
                                                                                fun(Field@0) -> {incompatible_collation_version, Field@0} end},
                                                                            {162,
                                                                                fun(Field@0) -> {collection_is_empty, Field@0} end},
                                                                            {163,
                                                                                fun(Field@0) -> {zone_still_in_use, Field@0} end},
                                                                            {164,
                                                                                fun(Field@0) -> {initial_sync_active, Field@0} end},
                                                                            {165,
                                                                                fun(Field@0) -> {view_depth_limit_exceeded, Field@0} end},
                                                                            {166,
                                                                                fun(Field@0) -> {command_not_supported_on_view, Field@0} end},
                                                                            {167,
                                                                                fun(Field@0) -> {option_not_supported_on_view, Field@0} end},
                                                                            {168,
                                                                                fun(Field@0) -> {invalid_pipeline_operator, Field@0} end},
                                                                            {169,
                                                                                fun(Field@0) -> {command_on_sharded_view_not_supported_on_mongod, Field@0} end},
                                                                            {170,
                                                                                fun(Field@0) -> {too_many_matching_documents, Field@0} end},
                                                                            {171,
                                                                                fun(Field@0) -> {cannot_index_parallel_arrays, Field@0} end},
                                                                            {172,
                                                                                fun(Field@0) -> {transport_session_closed, Field@0} end},
                                                                            {173,
                                                                                fun(Field@0) -> {transport_session_not_found, Field@0} end},
                                                                            {174,
                                                                                fun(Field@0) -> {transport_session_unknown, Field@0} end},
                                                                            {175,
                                                                                fun(Field@0) -> {query_plan_killed, Field@0} end},
                                                                            {176,
                                                                                fun(Field@0) -> {file_open_failed, Field@0} end},
                                                                            {177,
                                                                                fun(Field@0) -> {zone_not_found, Field@0} end},
                                                                            {178,
                                                                                fun(Field@0) -> {range_overlap_conflict, Field@0} end},
                                                                            {179,
                                                                                fun(Field@0) -> {windows_pdh_error, Field@0} end},
                                                                            {180,
                                                                                fun(Field@0) -> {bad_perf_counter_path, Field@0} end},
                                                                            {181,
                                                                                fun(Field@0) -> {ambiguous_index_key_pattern, Field@0} end},
                                                                            {182,
                                                                                fun(Field@0) -> {invalid_view_definition, Field@0} end},
                                                                            {183,
                                                                                fun(Field@0) -> {client_metadata_missing_field, Field@0} end},
                                                                            {184,
                                                                                fun(Field@0) -> {client_metadata_app_name_too_large, Field@0} end},
                                                                            {185,
                                                                                fun(Field@0) -> {client_metadata_document_too_large, Field@0} end},
                                                                            {186,
                                                                                fun(Field@0) -> {client_metadata_cannot_be_mutated, Field@0} end},
                                                                            {187,
                                                                                fun(Field@0) -> {linearizable_read_concern_error, Field@0} end},
                                                                            {188,
                                                                                fun(Field@0) -> {incompatible_server_version, Field@0} end},
                                                                            {189,
                                                                                fun(Field@0) -> {primary_stepped_down, Field@0} end},
                                                                            {190,
                                                                                fun(Field@0) -> {master_slave_connection_failure, Field@0} end},
                                                                            {192,
                                                                                fun(Field@0) -> {fail_point_enabled, Field@0} end},
                                                                            {193,
                                                                                fun(Field@0) -> {no_sharding_enabled, Field@0} end},
                                                                            {194,
                                                                                fun(Field@0) -> {balancer_interrupted, Field@0} end},
                                                                            {195,
                                                                                fun(Field@0) -> {view_pipeline_max_size_exceeded, Field@0} end},
                                                                            {197,
                                                                                fun(Field@0) -> {invalid_index_specification_option, Field@0} end},
                                                                            {199,
                                                                                fun(Field@0) -> {replica_set_monitor_removed, Field@0} end},
                                                                            {200,
                                                                                fun(Field@0) -> {chunk_range_cleanup_pending, Field@0} end},
                                                                            {201,
                                                                                fun(Field@0) -> {cannot_build_index_keys, Field@0} end},
                                                                            {202,
                                                                                fun(Field@0) -> {network_interface_exceeded_time_limit, Field@0} end},
                                                                            {203,
                                                                                fun(Field@0) -> {sharding_state_not_initialized, Field@0} end},
                                                                            {204,
                                                                                fun(Field@0) -> {time_proof_mismatch, Field@0} end},
                                                                            {205,
                                                                                fun(Field@0) -> {cluster_time_fails_rate_limiter, Field@0} end},
                                                                            {206,
                                                                                fun(Field@0) -> {no_such_session, Field@0} end},
                                                                            {207,
                                                                                fun(Field@0) -> {invalid_uuid, Field@0} end},
                                                                            {208,
                                                                                fun(Field@0) -> {too_many_locks, Field@0} end},
                                                                            {209,
                                                                                fun(Field@0) -> {stale_cluster_time, Field@0} end},
                                                                            {210,
                                                                                fun(Field@0) -> {cannot_verify_and_sign_logical_time, Field@0} end},
                                                                            {211,
                                                                                fun(Field@0) -> {key_not_found, Field@0} end},
                                                                            {212,
                                                                                fun(Field@0) -> {incompatible_rollback_algorithm, Field@0} end},
                                                                            {213,
                                                                                fun(Field@0) -> {duplicate_session, Field@0} end},
                                                                            {214,
                                                                                fun(Field@0) -> {authentication_restriction_unmet, Field@0} end},
                                                                            {215,
                                                                                fun(Field@0) -> {database_drop_pending, Field@0} end},
                                                                            {216,
                                                                                fun(Field@0) -> {election_in_progress, Field@0} end},
                                                                            {217,
                                                                                fun(Field@0) -> {incomplete_transaction_history, Field@0} end},
                                                                            {218,
                                                                                fun(Field@0) -> {update_operation_failed, Field@0} end},
                                                                            {219,
                                                                                fun(Field@0) -> {ftdc_path_not_set, Field@0} end},
                                                                            {220,
                                                                                fun(Field@0) -> {ftdc_path_already_set, Field@0} end},
                                                                            {221,
                                                                                fun(Field@0) -> {index_modified, Field@0} end},
                                                                            {222,
                                                                                fun(Field@0) -> {close_change_stream, Field@0} end},
                                                                            {223,
                                                                                fun(Field@0) -> {illegal_op_msg_flag, Field@0} end},
                                                                            {224,
                                                                                fun(Field@0) -> {query_feature_not_allowed, Field@0} end},
                                                                            {225,
                                                                                fun(Field@0) -> {transaction_too_old, Field@0} end},
                                                                            {226,
                                                                                fun(Field@0) -> {atomicity_failure, Field@0} end},
                                                                            {227,
                                                                                fun(Field@0) -> {cannot_implicitly_create_collection, Field@0} end},
                                                                            {228,
                                                                                fun(Field@0) -> {session_transfer_incomplete, Field@0} end},
                                                                            {229,
                                                                                fun(Field@0) -> {must_downgrade, Field@0} end},
                                                                            {230,
                                                                                fun(Field@0) -> {dns_host_not_found, Field@0} end},
                                                                            {231,
                                                                                fun(Field@0) -> {dns_protocol_error, Field@0} end},
                                                                            {232,
                                                                                fun(Field@0) -> {max_sub_pipeline_depth_exceeded, Field@0} end},
                                                                            {233,
                                                                                fun(Field@0) -> {too_many_document_sequences, Field@0} end},
                                                                            {234,
                                                                                fun(Field@0) -> {retry_change_stream, Field@0} end},
                                                                            {235,
                                                                                fun(Field@0) -> {internal_error_not_supported, Field@0} end},
                                                                            {236,
                                                                                fun(Field@0) -> {for_testing_error_extra_info, Field@0} end},
                                                                            {237,
                                                                                fun(Field@0) -> {cursor_killed, Field@0} end},
                                                                            {238,
                                                                                fun(Field@0) -> {not_implemented, Field@0} end},
                                                                            {239,
                                                                                fun(Field@0) -> {snapshot_too_old, Field@0} end},
                                                                            {240,
                                                                                fun(Field@0) -> {dns_record_type_mismatch, Field@0} end},
                                                                            {241,
                                                                                fun(Field@0) -> {conversion_failure, Field@0} end},
                                                                            {242,
                                                                                fun(Field@0) -> {cannot_create_collection, Field@0} end},
                                                                            {243,
                                                                                fun(Field@0) -> {incompatible_with_upgraded_server, Field@0} end},
                                                                            {245,
                                                                                fun(Field@0) -> {broken_promise, Field@0} end},
                                                                            {246,
                                                                                fun(Field@0) -> {snapshot_unavailable, Field@0} end},
                                                                            {247,
                                                                                fun(Field@0) -> {producer_consumer_queue_batch_too_large, Field@0} end},
                                                                            {248,
                                                                                fun(Field@0) -> {producer_consumer_queue_end_closed, Field@0} end},
                                                                            {249,
                                                                                fun(Field@0) -> {stale_db_version, Field@0} end},
                                                                            {250,
                                                                                fun(Field@0) -> {stale_chunk_history, Field@0} end},
                                                                            {251,
                                                                                fun(Field@0) -> {no_such_transaction, Field@0} end},
                                                                            {252,
                                                                                fun(Field@0) -> {reentrancy_not_allowed, Field@0} end},
                                                                            {253,
                                                                                fun(Field@0) -> {free_mon_http_in_flight, Field@0} end},
                                                                            {254,
                                                                                fun(Field@0) -> {free_mon_http_temporary_failure, Field@0} end},
                                                                            {255,
                                                                                fun(Field@0) -> {free_mon_http_permanent_failure, Field@0} end},
                                                                            {256,
                                                                                fun(Field@0) -> {transaction_committed, Field@0} end},
                                                                            {257,
                                                                                fun(Field@0) -> {transaction_too_large, Field@0} end},
                                                                            {258,
                                                                                fun(Field@0) -> {unknown_feature_compatibility_version, Field@0} end},
                                                                            {259,
                                                                                fun(Field@0) -> {keyed_executor_retry, Field@0} end},
                                                                            {260,
                                                                                fun(Field@0) -> {invalid_resume_token, Field@0} end},
                                                                            {261,
                                                                                fun(Field@0) -> {too_many_logical_sessions, Field@0} end},
                                                                            {262,
                                                                                fun(Field@0) -> {exceeded_time_limit, Field@0} end},
                                                                            {263,
                                                                                fun(Field@0) -> {operation_not_supported_in_transaction, Field@0} end},
                                                                            {264,
                                                                                fun(Field@0) -> {too_many_files_open, Field@0} end},
                                                                            {265,
                                                                                fun(Field@0) -> {orphaned_range_clean_up_failed, Field@0} end},
                                                                            {266,
                                                                                fun(Field@0) -> {fail_point_set_failed, Field@0} end},
                                                                            {267,
                                                                                fun(Field@0) -> {prepared_transaction_in_progress, Field@0} end},
                                                                            {268,
                                                                                fun(Field@0) -> {cannot_backup, Field@0} end},
                                                                            {269,
                                                                                fun(Field@0) -> {data_modified_by_repair, Field@0} end},
                                                                            {270,
                                                                                fun(Field@0) -> {repaired_replica_set_node, Field@0} end},
                                                                            {271,
                                                                                fun(Field@0) -> {js_interpreter_failure_with_stack, Field@0} end},
                                                                            {272,
                                                                                fun(Field@0) -> {migration_conflict, Field@0} end},
                                                                            {273,
                                                                                fun(Field@0) -> {producer_consumer_queue_producer_queue_depth_exceeded, Field@0} end},
                                                                            {274,
                                                                                fun(Field@0) -> {producer_consumer_queue_consumed, Field@0} end},
                                                                            {275,
                                                                                fun(Field@0) -> {exchange_passthrough, Field@0} end},
                                                                            {276,
                                                                                fun(Field@0) -> {index_build_aborted, Field@0} end},
                                                                            {277,
                                                                                fun(Field@0) -> {alarm_already_fulfilled, Field@0} end},
                                                                            {278,
                                                                                fun(Field@0) -> {unsatisfiable_commit_quorum, Field@0} end},
                                                                            {279,
                                                                                fun(Field@0) -> {client_disconnect, Field@0} end},
                                                                            {280,
                                                                                fun(Field@0) -> {change_stream_fatal_error, Field@0} end},
                                                                            {281,
                                                                                fun(Field@0) -> {transaction_coordinator_stepping_down, Field@0} end},
                                                                            {282,
                                                                                fun(Field@0) -> {transaction_coordinator_reached_abort_decision, Field@0} end},
                                                                            {283,
                                                                                fun(Field@0) -> {would_change_owning_shard, Field@0} end},
                                                                            {284,
                                                                                fun(Field@0) -> {for_testing_error_extra_info_with_extra_info_in_namespace, Field@0} end},
                                                                            {285,
                                                                                fun(Field@0) -> {index_build_already_in_progress, Field@0} end},
                                                                            {286,
                                                                                fun(Field@0) -> {change_stream_history_lost, Field@0} end},
                                                                            {287,
                                                                                fun(Field@0) -> {transaction_coordinator_deadline_task_canceled, Field@0} end},
                                                                            {288,
                                                                                fun(Field@0) -> {checksum_mismatch, Field@0} end},
                                                                            {289,
                                                                                fun(Field@0) -> {wait_for_majority_service_earlier_op_time_available, Field@0} end},
                                                                            {290,
                                                                                fun(Field@0) -> {transaction_exceeded_lifetime_limit_seconds, Field@0} end},
                                                                            {291,
                                                                                fun(Field@0) -> {no_query_execution_plans, Field@0} end},
                                                                            {292,
                                                                                fun(Field@0) -> {query_exceeded_memory_limit_no_disk_use_allowed, Field@0} end},
                                                                            {293,
                                                                                fun(Field@0) -> {invalid_seed_list, Field@0} end},
                                                                            {294,
                                                                                fun(Field@0) -> {invalid_topology_type, Field@0} end},
                                                                            {295,
                                                                                fun(Field@0) -> {invalid_heart_beat_frequency, Field@0} end},
                                                                            {296,
                                                                                fun(Field@0) -> {topology_set_name_required, Field@0} end},
                                                                            {297,
                                                                                fun(Field@0) -> {hierarchical_acquisition_level_violation, Field@0} end},
                                                                            {298,
                                                                                fun(Field@0) -> {invalid_server_type, Field@0} end},
                                                                            {299,
                                                                                fun(Field@0) -> {ocsp_certificate_status_revoked, Field@0} end},
                                                                            {300,
                                                                                fun(Field@0) -> {range_deletion_abandoned_because_collection_with_uuid_does_not_exist, Field@0} end},
                                                                            {301,
                                                                                fun(Field@0) -> {data_corruption_detected, Field@0} end},
                                                                            {302,
                                                                                fun(Field@0) -> {ocsp_certificate_status_unknown, Field@0} end},
                                                                            {303,
                                                                                fun(Field@0) -> {split_horizon_change, Field@0} end},
                                                                            {304,
                                                                                fun(Field@0) -> {shard_invalidated_for_targeting, Field@0} end},
                                                                            {306,
                                                                                fun(Field@0) -> {read_through_cache_lookup_canceled, Field@0} end},
                                                                            {307,
                                                                                fun(Field@0) -> {range_deletion_abandoned_because_task_document_does_not_exist, Field@0} end},
                                                                            {308,
                                                                                fun(Field@0) -> {current_config_not_committed_yet, Field@0} end},
                                                                            {309,
                                                                                fun(Field@0) -> {exhaust_command_finished, Field@0} end},
                                                                            {310,
                                                                                fun(Field@0) -> {periodic_job_is_stopped, Field@0} end},
                                                                            {311,
                                                                                fun(Field@0) -> {transaction_coordinator_canceled, Field@0} end},
                                                                            {312,
                                                                                fun(Field@0) -> {operation_is_killed_and_delisted, Field@0} end},
                                                                            {313,
                                                                                fun(Field@0) -> {resumable_range_deleter_disabled, Field@0} end},
                                                                            {314,
                                                                                fun(Field@0) -> {object_is_busy, Field@0} end},
                                                                            {315,
                                                                                fun(Field@0) -> {too_stale_to_sync_from_source, Field@0} end},
                                                                            {316,
                                                                                fun(Field@0) -> {query_trial_run_completed, Field@0} end},
                                                                            {317,
                                                                                fun(Field@0) -> {connection_pool_expired, Field@0} end},
                                                                            {318,
                                                                                fun(Field@0) -> {for_testing_optional_error_extra_info, Field@0} end},
                                                                            {319,
                                                                                fun(Field@0) -> {move_primary_in_progress, Field@0} end},
                                                                            {320,
                                                                                fun(Field@0) -> {tenant_migration_conflict, Field@0} end},
                                                                            {321,
                                                                                fun(Field@0) -> {tenant_migration_committed, Field@0} end},
                                                                            {322,
                                                                                fun(Field@0) -> {api_version_error, Field@0} end},
                                                                            {323,
                                                                                fun(Field@0) -> {api_strict_error, Field@0} end},
                                                                            {324,
                                                                                fun(Field@0) -> {api_deprecation_error, Field@0} end},
                                                                            {325,
                                                                                fun(Field@0) -> {tenant_migration_aborted, Field@0} end},
                                                                            {326,
                                                                                fun(Field@0) -> {oplog_query_min_ts_missing, Field@0} end},
                                                                            {327,
                                                                                fun(Field@0) -> {no_such_tenant_migration, Field@0} end},
                                                                            {328,
                                                                                fun(Field@0) -> {tenant_migration_access_blocker_shutting_down, Field@0} end},
                                                                            {329,
                                                                                fun(Field@0) -> {tenant_migration_in_progress, Field@0} end},
                                                                            {330,
                                                                                fun(Field@0) -> {skip_command_execution, Field@0} end},
                                                                            {331,
                                                                                fun(Field@0) -> {failed_to_run_with_reply_builder, Field@0} end},
                                                                            {332,
                                                                                fun(Field@0) -> {cannot_downgrade, Field@0} end},
                                                                            {333,
                                                                                fun(Field@0) -> {service_executor_in_shutdown, Field@0} end},
                                                                            {334,
                                                                                fun(Field@0) -> {mechanism_unavailable, Field@0} end},
                                                                            {335,
                                                                                fun(Field@0) -> {tenant_migration_forgotten, Field@0} end},
                                                                            {9001,
                                                                                fun(Field@0) -> {socket_exception, Field@0} end},
                                                                            {10003,
                                                                                fun(Field@0) -> {cannot_grow_document_in_capped_namespace, Field@0} end},
                                                                            {10107,
                                                                                fun(Field@0) -> {not_writable_primary, Field@0} end},
                                                                            {10334,
                                                                                fun(Field@0) -> {bson_object_too_large, Field@0} end},
                                                                            {11000,
                                                                                fun(Field@0) -> {duplicate_key, Field@0} end},
                                                                            {11600,
                                                                                fun(Field@0) -> {interrupted_at_shutdown, Field@0} end},
                                                                            {11601,
                                                                                fun(Field@0) -> {interrupted, Field@0} end},
                                                                            {11602,
                                                                                fun(Field@0) -> {interrupted_due_to_repl_state_change, Field@0} end},
                                                                            {12586,
                                                                                fun(Field@0) -> {background_operation_in_progress_for_database, Field@0} end},
                                                                            {12587,
                                                                                fun(Field@0) -> {background_operation_in_progress_for_namespace, Field@0} end},
                                                                            {13113,
                                                                                fun(Field@0) -> {merge_stage_no_matching_document, Field@0} end},
                                                                            {13297,
                                                                                fun(Field@0) -> {database_differ_case, Field@0} end},
                                                                            {13388,
                                                                                fun(Field@0) -> {stale_config, Field@0} end},
                                                                            {13435,
                                                                                fun(Field@0) -> {not_primary_no_secondary_ok, Field@0} end},
                                                                            {13436,
                                                                                fun(Field@0) -> {not_primary_or_secondary, Field@0} end},
                                                                            {14031,
                                                                                fun(Field@0) -> {out_of_disk_space, Field@0} end},
                                                                            {46841,
                                                                                fun(Field@0) -> {client_marked_killed, Field@0} end}],
                                                                        Code@1
                                                                    ),
                                                                    {ok,
                                                                        Error@2} = case _assert_subject@3 of
                                                                        {ok, _} -> _assert_subject@3;
                                                                        _assert_fail@3 ->
                                                                            erlang:error(
                                                                                    #{gleam_error => let_assert,
                                                                                        message => <<"Assertion pattern match failed"/utf8>>,
                                                                                        value => _assert_fail@3,
                                                                                        module => <<"mungo/client"/utf8>>,
                                                                                        function => <<"execute"/utf8>>,
                                                                                        line => 182}
                                                                                )
                                                                    end,
                                                                    {error,
                                                                        {server_error,
                                                                            Error@2(
                                                                                Msg@1
                                                                            )}};

                                                                {_, _, _} ->
                                                                    {ok,
                                                                        {Reply@1,
                                                                            Client}}
                                                            end;

                                                        {error, Error@3} ->
                                                            {error, Error@3}
                                                    end
                                                end
                                            );

                                        false ->
                                            case send_cmd(
                                                Socket,
                                                Name,
                                                Cmd,
                                                Timeout
                                            ) of
                                                {ok, Reply@2} ->
                                                    case {gleam@dict:get(
                                                            Reply@2,
                                                            <<"ok"/utf8>>
                                                        ),
                                                        gleam@dict:get(
                                                            Reply@2,
                                                            <<"errmsg"/utf8>>
                                                        ),
                                                        gleam@dict:get(
                                                            Reply@2,
                                                            <<"code"/utf8>>
                                                        )} of
                                                        {{ok, {double, +0.0}},
                                                            {ok,
                                                                {string, Msg@2}},
                                                            {ok,
                                                                {int32, Code@2}}} ->
                                                            _assert_subject@4 = gleam@list:key_find(
                                                                [{0,
                                                                        fun(Field@0) -> {ok, Field@0} end},
                                                                    {1,
                                                                        fun(Field@0) -> {internal_error, Field@0} end},
                                                                    {2,
                                                                        fun(Field@0) -> {bad_value, Field@0} end},
                                                                    {4,
                                                                        fun(Field@0) -> {no_such_key, Field@0} end},
                                                                    {5,
                                                                        fun(Field@0) -> {graph_contains_cycle, Field@0} end},
                                                                    {6,
                                                                        fun(Field@0) -> {host_unreachable, Field@0} end},
                                                                    {7,
                                                                        fun(Field@0) -> {host_not_found, Field@0} end},
                                                                    {8,
                                                                        fun(Field@0) -> {unknown_error, Field@0} end},
                                                                    {9,
                                                                        fun(Field@0) -> {failed_to_parse, Field@0} end},
                                                                    {10,
                                                                        fun(Field@0) -> {cannot_mutate_object, Field@0} end},
                                                                    {11,
                                                                        fun(Field@0) -> {user_not_found, Field@0} end},
                                                                    {12,
                                                                        fun(Field@0) -> {unsupported_format, Field@0} end},
                                                                    {13,
                                                                        fun(Field@0) -> {unauthorized, Field@0} end},
                                                                    {14,
                                                                        fun(Field@0) -> {type_mismatch, Field@0} end},
                                                                    {15,
                                                                        fun(Field@0) -> {overflow, Field@0} end},
                                                                    {16,
                                                                        fun(Field@0) -> {invalid_length, Field@0} end},
                                                                    {17,
                                                                        fun(Field@0) -> {protocol_error, Field@0} end},
                                                                    {18,
                                                                        fun(Field@0) -> {authentication_failed, Field@0} end},
                                                                    {19,
                                                                        fun(Field@0) -> {cannot_reuse_object, Field@0} end},
                                                                    {20,
                                                                        fun(Field@0) -> {illegal_operation, Field@0} end},
                                                                    {21,
                                                                        fun(Field@0) -> {empty_array_operation, Field@0} end},
                                                                    {22,
                                                                        fun(Field@0) -> {invalid_bson, Field@0} end},
                                                                    {23,
                                                                        fun(Field@0) -> {already_initialized, Field@0} end},
                                                                    {24,
                                                                        fun(Field@0) -> {lock_timeout, Field@0} end},
                                                                    {25,
                                                                        fun(Field@0) -> {remote_validation_error, Field@0} end},
                                                                    {26,
                                                                        fun(Field@0) -> {namespace_not_found, Field@0} end},
                                                                    {27,
                                                                        fun(Field@0) -> {index_not_found, Field@0} end},
                                                                    {28,
                                                                        fun(Field@0) -> {path_not_viable, Field@0} end},
                                                                    {29,
                                                                        fun(Field@0) -> {non_existent_path, Field@0} end},
                                                                    {30,
                                                                        fun(Field@0) -> {invalid_path, Field@0} end},
                                                                    {31,
                                                                        fun(Field@0) -> {role_not_found, Field@0} end},
                                                                    {32,
                                                                        fun(Field@0) -> {roles_not_related, Field@0} end},
                                                                    {33,
                                                                        fun(Field@0) -> {privilege_not_found, Field@0} end},
                                                                    {34,
                                                                        fun(Field@0) -> {cannot_backfill_array, Field@0} end},
                                                                    {35,
                                                                        fun(Field@0) -> {user_modification_failed, Field@0} end},
                                                                    {36,
                                                                        fun(Field@0) -> {remote_change_detected, Field@0} end},
                                                                    {37,
                                                                        fun(Field@0) -> {file_rename_failed, Field@0} end},
                                                                    {38,
                                                                        fun(Field@0) -> {file_not_open, Field@0} end},
                                                                    {39,
                                                                        fun(Field@0) -> {file_stream_failed, Field@0} end},
                                                                    {40,
                                                                        fun(Field@0) -> {conflicting_update_operators, Field@0} end},
                                                                    {41,
                                                                        fun(Field@0) -> {file_already_open, Field@0} end},
                                                                    {42,
                                                                        fun(Field@0) -> {log_write_failed, Field@0} end},
                                                                    {43,
                                                                        fun(Field@0) -> {cursor_not_found, Field@0} end},
                                                                    {45,
                                                                        fun(Field@0) -> {user_data_inconsistent, Field@0} end},
                                                                    {46,
                                                                        fun(Field@0) -> {lock_busy, Field@0} end},
                                                                    {47,
                                                                        fun(Field@0) -> {no_matching_document, Field@0} end},
                                                                    {48,
                                                                        fun(Field@0) -> {namespace_exists, Field@0} end},
                                                                    {49,
                                                                        fun(Field@0) -> {invalid_role_modification, Field@0} end},
                                                                    {50,
                                                                        fun(Field@0) -> {max_time_ms_expired, Field@0} end},
                                                                    {51,
                                                                        fun(Field@0) -> {manual_intervention_required, Field@0} end},
                                                                    {52,
                                                                        fun(Field@0) -> {dollar_prefixed_field_name, Field@0} end},
                                                                    {53,
                                                                        fun(Field@0) -> {invalid_id_field, Field@0} end},
                                                                    {54,
                                                                        fun(Field@0) -> {not_single_value_field, Field@0} end},
                                                                    {55,
                                                                        fun(Field@0) -> {invalid_db_ref, Field@0} end},
                                                                    {56,
                                                                        fun(Field@0) -> {empty_field_name, Field@0} end},
                                                                    {57,
                                                                        fun(Field@0) -> {dotted_field_name, Field@0} end},
                                                                    {58,
                                                                        fun(Field@0) -> {role_modification_failed, Field@0} end},
                                                                    {59,
                                                                        fun(Field@0) -> {command_not_found, Field@0} end},
                                                                    {61,
                                                                        fun(Field@0) -> {shard_key_not_found, Field@0} end},
                                                                    {62,
                                                                        fun(Field@0) -> {oplog_operation_unsupported, Field@0} end},
                                                                    {63,
                                                                        fun(Field@0) -> {stale_shard_version, Field@0} end},
                                                                    {64,
                                                                        fun(Field@0) -> {write_concern_failed, Field@0} end},
                                                                    {65,
                                                                        fun(Field@0) -> {multiple_errors_occurred, Field@0} end},
                                                                    {66,
                                                                        fun(Field@0) -> {immutable_field, Field@0} end},
                                                                    {67,
                                                                        fun(Field@0) -> {cannot_create_index, Field@0} end},
                                                                    {68,
                                                                        fun(Field@0) -> {index_already_exists, Field@0} end},
                                                                    {69,
                                                                        fun(Field@0) -> {auth_schema_incompatible, Field@0} end},
                                                                    {70,
                                                                        fun(Field@0) -> {shard_not_found, Field@0} end},
                                                                    {71,
                                                                        fun(Field@0) -> {replica_set_not_found, Field@0} end},
                                                                    {72,
                                                                        fun(Field@0) -> {invalid_options, Field@0} end},
                                                                    {73,
                                                                        fun(Field@0) -> {invalid_namespace, Field@0} end},
                                                                    {74,
                                                                        fun(Field@0) -> {node_not_found, Field@0} end},
                                                                    {75,
                                                                        fun(Field@0) -> {write_concern_legacy_ok, Field@0} end},
                                                                    {76,
                                                                        fun(Field@0) -> {no_replication_enabled, Field@0} end},
                                                                    {77,
                                                                        fun(Field@0) -> {operation_incomplete, Field@0} end},
                                                                    {78,
                                                                        fun(Field@0) -> {command_result_schema_violation, Field@0} end},
                                                                    {79,
                                                                        fun(Field@0) -> {unknown_repl_write_concern, Field@0} end},
                                                                    {80,
                                                                        fun(Field@0) -> {role_data_inconsistent, Field@0} end},
                                                                    {81,
                                                                        fun(Field@0) -> {no_match_parse_context, Field@0} end},
                                                                    {82,
                                                                        fun(Field@0) -> {no_progress_made, Field@0} end},
                                                                    {83,
                                                                        fun(Field@0) -> {remote_results_unavailable, Field@0} end},
                                                                    {85,
                                                                        fun(Field@0) -> {index_options_conflict, Field@0} end},
                                                                    {86,
                                                                        fun(Field@0) -> {index_key_specs_conflict, Field@0} end},
                                                                    {87,
                                                                        fun(Field@0) -> {cannot_split, Field@0} end},
                                                                    {89,
                                                                        fun(Field@0) -> {network_timeout, Field@0} end},
                                                                    {90,
                                                                        fun(Field@0) -> {callback_canceled, Field@0} end},
                                                                    {91,
                                                                        fun(Field@0) -> {shutdown_in_progress, Field@0} end},
                                                                    {92,
                                                                        fun(Field@0) -> {secondary_ahead_of_primary, Field@0} end},
                                                                    {93,
                                                                        fun(Field@0) -> {invalid_replica_set_config, Field@0} end},
                                                                    {94,
                                                                        fun(Field@0) -> {not_yet_initialized, Field@0} end},
                                                                    {95,
                                                                        fun(Field@0) -> {not_secondary, Field@0} end},
                                                                    {96,
                                                                        fun(Field@0) -> {operation_failed, Field@0} end},
                                                                    {97,
                                                                        fun(Field@0) -> {no_projection_found, Field@0} end},
                                                                    {98,
                                                                        fun(Field@0) -> {db_path_in_use, Field@0} end},
                                                                    {100,
                                                                        fun(Field@0) -> {unsatisfiable_write_concern, Field@0} end},
                                                                    {101,
                                                                        fun(Field@0) -> {outdated_client, Field@0} end},
                                                                    {102,
                                                                        fun(Field@0) -> {incompatible_audit_metadata, Field@0} end},
                                                                    {103,
                                                                        fun(Field@0) -> {new_replica_set_configuration_incompatible, Field@0} end},
                                                                    {104,
                                                                        fun(Field@0) -> {node_not_electable, Field@0} end},
                                                                    {105,
                                                                        fun(Field@0) -> {incompatible_sharding_metadata, Field@0} end},
                                                                    {106,
                                                                        fun(Field@0) -> {distributed_clock_skewed, Field@0} end},
                                                                    {107,
                                                                        fun(Field@0) -> {lock_failed, Field@0} end},
                                                                    {108,
                                                                        fun(Field@0) -> {inconsistent_replica_set_names, Field@0} end},
                                                                    {109,
                                                                        fun(Field@0) -> {configuration_in_progress, Field@0} end},
                                                                    {110,
                                                                        fun(Field@0) -> {cannot_initialize_node_with_data, Field@0} end},
                                                                    {111,
                                                                        fun(Field@0) -> {not_exact_value_field, Field@0} end},
                                                                    {112,
                                                                        fun(Field@0) -> {write_conflict, Field@0} end},
                                                                    {113,
                                                                        fun(Field@0) -> {initial_sync_failure, Field@0} end},
                                                                    {114,
                                                                        fun(Field@0) -> {initial_sync_oplog_source_missing, Field@0} end},
                                                                    {115,
                                                                        fun(Field@0) -> {command_not_supported, Field@0} end},
                                                                    {116,
                                                                        fun(Field@0) -> {doc_too_large_for_capped, Field@0} end},
                                                                    {117,
                                                                        fun(Field@0) -> {conflicting_operation_in_progress, Field@0} end},
                                                                    {118,
                                                                        fun(Field@0) -> {namespace_not_sharded, Field@0} end},
                                                                    {119,
                                                                        fun(Field@0) -> {invalid_sync_source, Field@0} end},
                                                                    {120,
                                                                        fun(Field@0) -> {oplog_start_missing, Field@0} end},
                                                                    {121,
                                                                        fun(Field@0) -> {document_validation_failure, Field@0} end},
                                                                    {123,
                                                                        fun(Field@0) -> {not_a_replica_set, Field@0} end},
                                                                    {124,
                                                                        fun(Field@0) -> {incompatible_election_protocol, Field@0} end},
                                                                    {125,
                                                                        fun(Field@0) -> {command_failed, Field@0} end},
                                                                    {126,
                                                                        fun(Field@0) -> {rpc_protocol_negotiation_failed, Field@0} end},
                                                                    {127,
                                                                        fun(Field@0) -> {unrecoverable_rollback_error, Field@0} end},
                                                                    {128,
                                                                        fun(Field@0) -> {lock_not_found, Field@0} end},
                                                                    {129,
                                                                        fun(Field@0) -> {lock_state_change_failed, Field@0} end},
                                                                    {130,
                                                                        fun(Field@0) -> {symbol_not_found, Field@0} end},
                                                                    {133,
                                                                        fun(Field@0) -> {failed_to_satisfy_read_preference, Field@0} end},
                                                                    {134,
                                                                        fun(Field@0) -> {read_concern_majority_not_available_yet, Field@0} end},
                                                                    {135,
                                                                        fun(Field@0) -> {stale_term, Field@0} end},
                                                                    {136,
                                                                        fun(Field@0) -> {capped_position_lost, Field@0} end},
                                                                    {137,
                                                                        fun(Field@0) -> {incompatible_sharding_config_version, Field@0} end},
                                                                    {138,
                                                                        fun(Field@0) -> {remote_oplog_stale, Field@0} end},
                                                                    {139,
                                                                        fun(Field@0) -> {js_interpreter_failure, Field@0} end},
                                                                    {140,
                                                                        fun(Field@0) -> {invalid_ssl_configuration, Field@0} end},
                                                                    {141,
                                                                        fun(Field@0) -> {ssl_handshake_failed, Field@0} end},
                                                                    {142,
                                                                        fun(Field@0) -> {js_uncatchable_error, Field@0} end},
                                                                    {143,
                                                                        fun(Field@0) -> {cursor_in_use, Field@0} end},
                                                                    {144,
                                                                        fun(Field@0) -> {incompatible_catalog_manager, Field@0} end},
                                                                    {145,
                                                                        fun(Field@0) -> {pooled_connections_dropped, Field@0} end},
                                                                    {146,
                                                                        fun(Field@0) -> {exceeded_memory_limit, Field@0} end},
                                                                    {147,
                                                                        fun(Field@0) -> {z_lib_error, Field@0} end},
                                                                    {148,
                                                                        fun(Field@0) -> {read_concern_majority_not_enabled, Field@0} end},
                                                                    {149,
                                                                        fun(Field@0) -> {no_config_primary, Field@0} end},
                                                                    {150,
                                                                        fun(Field@0) -> {stale_epoch, Field@0} end},
                                                                    {151,
                                                                        fun(Field@0) -> {operation_cannot_be_batched, Field@0} end},
                                                                    {152,
                                                                        fun(Field@0) -> {oplog_out_of_order, Field@0} end},
                                                                    {153,
                                                                        fun(Field@0) -> {chunk_too_big, Field@0} end},
                                                                    {154,
                                                                        fun(Field@0) -> {inconsistent_shard_identity, Field@0} end},
                                                                    {155,
                                                                        fun(Field@0) -> {cannot_apply_oplog_while_primary, Field@0} end},
                                                                    {157,
                                                                        fun(Field@0) -> {can_repair_to_downgrade, Field@0} end},
                                                                    {158,
                                                                        fun(Field@0) -> {must_upgrade, Field@0} end},
                                                                    {159,
                                                                        fun(Field@0) -> {duration_overflow, Field@0} end},
                                                                    {160,
                                                                        fun(Field@0) -> {max_staleness_out_of_range, Field@0} end},
                                                                    {161,
                                                                        fun(Field@0) -> {incompatible_collation_version, Field@0} end},
                                                                    {162,
                                                                        fun(Field@0) -> {collection_is_empty, Field@0} end},
                                                                    {163,
                                                                        fun(Field@0) -> {zone_still_in_use, Field@0} end},
                                                                    {164,
                                                                        fun(Field@0) -> {initial_sync_active, Field@0} end},
                                                                    {165,
                                                                        fun(Field@0) -> {view_depth_limit_exceeded, Field@0} end},
                                                                    {166,
                                                                        fun(Field@0) -> {command_not_supported_on_view, Field@0} end},
                                                                    {167,
                                                                        fun(Field@0) -> {option_not_supported_on_view, Field@0} end},
                                                                    {168,
                                                                        fun(Field@0) -> {invalid_pipeline_operator, Field@0} end},
                                                                    {169,
                                                                        fun(Field@0) -> {command_on_sharded_view_not_supported_on_mongod, Field@0} end},
                                                                    {170,
                                                                        fun(Field@0) -> {too_many_matching_documents, Field@0} end},
                                                                    {171,
                                                                        fun(Field@0) -> {cannot_index_parallel_arrays, Field@0} end},
                                                                    {172,
                                                                        fun(Field@0) -> {transport_session_closed, Field@0} end},
                                                                    {173,
                                                                        fun(Field@0) -> {transport_session_not_found, Field@0} end},
                                                                    {174,
                                                                        fun(Field@0) -> {transport_session_unknown, Field@0} end},
                                                                    {175,
                                                                        fun(Field@0) -> {query_plan_killed, Field@0} end},
                                                                    {176,
                                                                        fun(Field@0) -> {file_open_failed, Field@0} end},
                                                                    {177,
                                                                        fun(Field@0) -> {zone_not_found, Field@0} end},
                                                                    {178,
                                                                        fun(Field@0) -> {range_overlap_conflict, Field@0} end},
                                                                    {179,
                                                                        fun(Field@0) -> {windows_pdh_error, Field@0} end},
                                                                    {180,
                                                                        fun(Field@0) -> {bad_perf_counter_path, Field@0} end},
                                                                    {181,
                                                                        fun(Field@0) -> {ambiguous_index_key_pattern, Field@0} end},
                                                                    {182,
                                                                        fun(Field@0) -> {invalid_view_definition, Field@0} end},
                                                                    {183,
                                                                        fun(Field@0) -> {client_metadata_missing_field, Field@0} end},
                                                                    {184,
                                                                        fun(Field@0) -> {client_metadata_app_name_too_large, Field@0} end},
                                                                    {185,
                                                                        fun(Field@0) -> {client_metadata_document_too_large, Field@0} end},
                                                                    {186,
                                                                        fun(Field@0) -> {client_metadata_cannot_be_mutated, Field@0} end},
                                                                    {187,
                                                                        fun(Field@0) -> {linearizable_read_concern_error, Field@0} end},
                                                                    {188,
                                                                        fun(Field@0) -> {incompatible_server_version, Field@0} end},
                                                                    {189,
                                                                        fun(Field@0) -> {primary_stepped_down, Field@0} end},
                                                                    {190,
                                                                        fun(Field@0) -> {master_slave_connection_failure, Field@0} end},
                                                                    {192,
                                                                        fun(Field@0) -> {fail_point_enabled, Field@0} end},
                                                                    {193,
                                                                        fun(Field@0) -> {no_sharding_enabled, Field@0} end},
                                                                    {194,
                                                                        fun(Field@0) -> {balancer_interrupted, Field@0} end},
                                                                    {195,
                                                                        fun(Field@0) -> {view_pipeline_max_size_exceeded, Field@0} end},
                                                                    {197,
                                                                        fun(Field@0) -> {invalid_index_specification_option, Field@0} end},
                                                                    {199,
                                                                        fun(Field@0) -> {replica_set_monitor_removed, Field@0} end},
                                                                    {200,
                                                                        fun(Field@0) -> {chunk_range_cleanup_pending, Field@0} end},
                                                                    {201,
                                                                        fun(Field@0) -> {cannot_build_index_keys, Field@0} end},
                                                                    {202,
                                                                        fun(Field@0) -> {network_interface_exceeded_time_limit, Field@0} end},
                                                                    {203,
                                                                        fun(Field@0) -> {sharding_state_not_initialized, Field@0} end},
                                                                    {204,
                                                                        fun(Field@0) -> {time_proof_mismatch, Field@0} end},
                                                                    {205,
                                                                        fun(Field@0) -> {cluster_time_fails_rate_limiter, Field@0} end},
                                                                    {206,
                                                                        fun(Field@0) -> {no_such_session, Field@0} end},
                                                                    {207,
                                                                        fun(Field@0) -> {invalid_uuid, Field@0} end},
                                                                    {208,
                                                                        fun(Field@0) -> {too_many_locks, Field@0} end},
                                                                    {209,
                                                                        fun(Field@0) -> {stale_cluster_time, Field@0} end},
                                                                    {210,
                                                                        fun(Field@0) -> {cannot_verify_and_sign_logical_time, Field@0} end},
                                                                    {211,
                                                                        fun(Field@0) -> {key_not_found, Field@0} end},
                                                                    {212,
                                                                        fun(Field@0) -> {incompatible_rollback_algorithm, Field@0} end},
                                                                    {213,
                                                                        fun(Field@0) -> {duplicate_session, Field@0} end},
                                                                    {214,
                                                                        fun(Field@0) -> {authentication_restriction_unmet, Field@0} end},
                                                                    {215,
                                                                        fun(Field@0) -> {database_drop_pending, Field@0} end},
                                                                    {216,
                                                                        fun(Field@0) -> {election_in_progress, Field@0} end},
                                                                    {217,
                                                                        fun(Field@0) -> {incomplete_transaction_history, Field@0} end},
                                                                    {218,
                                                                        fun(Field@0) -> {update_operation_failed, Field@0} end},
                                                                    {219,
                                                                        fun(Field@0) -> {ftdc_path_not_set, Field@0} end},
                                                                    {220,
                                                                        fun(Field@0) -> {ftdc_path_already_set, Field@0} end},
                                                                    {221,
                                                                        fun(Field@0) -> {index_modified, Field@0} end},
                                                                    {222,
                                                                        fun(Field@0) -> {close_change_stream, Field@0} end},
                                                                    {223,
                                                                        fun(Field@0) -> {illegal_op_msg_flag, Field@0} end},
                                                                    {224,
                                                                        fun(Field@0) -> {query_feature_not_allowed, Field@0} end},
                                                                    {225,
                                                                        fun(Field@0) -> {transaction_too_old, Field@0} end},
                                                                    {226,
                                                                        fun(Field@0) -> {atomicity_failure, Field@0} end},
                                                                    {227,
                                                                        fun(Field@0) -> {cannot_implicitly_create_collection, Field@0} end},
                                                                    {228,
                                                                        fun(Field@0) -> {session_transfer_incomplete, Field@0} end},
                                                                    {229,
                                                                        fun(Field@0) -> {must_downgrade, Field@0} end},
                                                                    {230,
                                                                        fun(Field@0) -> {dns_host_not_found, Field@0} end},
                                                                    {231,
                                                                        fun(Field@0) -> {dns_protocol_error, Field@0} end},
                                                                    {232,
                                                                        fun(Field@0) -> {max_sub_pipeline_depth_exceeded, Field@0} end},
                                                                    {233,
                                                                        fun(Field@0) -> {too_many_document_sequences, Field@0} end},
                                                                    {234,
                                                                        fun(Field@0) -> {retry_change_stream, Field@0} end},
                                                                    {235,
                                                                        fun(Field@0) -> {internal_error_not_supported, Field@0} end},
                                                                    {236,
                                                                        fun(Field@0) -> {for_testing_error_extra_info, Field@0} end},
                                                                    {237,
                                                                        fun(Field@0) -> {cursor_killed, Field@0} end},
                                                                    {238,
                                                                        fun(Field@0) -> {not_implemented, Field@0} end},
                                                                    {239,
                                                                        fun(Field@0) -> {snapshot_too_old, Field@0} end},
                                                                    {240,
                                                                        fun(Field@0) -> {dns_record_type_mismatch, Field@0} end},
                                                                    {241,
                                                                        fun(Field@0) -> {conversion_failure, Field@0} end},
                                                                    {242,
                                                                        fun(Field@0) -> {cannot_create_collection, Field@0} end},
                                                                    {243,
                                                                        fun(Field@0) -> {incompatible_with_upgraded_server, Field@0} end},
                                                                    {245,
                                                                        fun(Field@0) -> {broken_promise, Field@0} end},
                                                                    {246,
                                                                        fun(Field@0) -> {snapshot_unavailable, Field@0} end},
                                                                    {247,
                                                                        fun(Field@0) -> {producer_consumer_queue_batch_too_large, Field@0} end},
                                                                    {248,
                                                                        fun(Field@0) -> {producer_consumer_queue_end_closed, Field@0} end},
                                                                    {249,
                                                                        fun(Field@0) -> {stale_db_version, Field@0} end},
                                                                    {250,
                                                                        fun(Field@0) -> {stale_chunk_history, Field@0} end},
                                                                    {251,
                                                                        fun(Field@0) -> {no_such_transaction, Field@0} end},
                                                                    {252,
                                                                        fun(Field@0) -> {reentrancy_not_allowed, Field@0} end},
                                                                    {253,
                                                                        fun(Field@0) -> {free_mon_http_in_flight, Field@0} end},
                                                                    {254,
                                                                        fun(Field@0) -> {free_mon_http_temporary_failure, Field@0} end},
                                                                    {255,
                                                                        fun(Field@0) -> {free_mon_http_permanent_failure, Field@0} end},
                                                                    {256,
                                                                        fun(Field@0) -> {transaction_committed, Field@0} end},
                                                                    {257,
                                                                        fun(Field@0) -> {transaction_too_large, Field@0} end},
                                                                    {258,
                                                                        fun(Field@0) -> {unknown_feature_compatibility_version, Field@0} end},
                                                                    {259,
                                                                        fun(Field@0) -> {keyed_executor_retry, Field@0} end},
                                                                    {260,
                                                                        fun(Field@0) -> {invalid_resume_token, Field@0} end},
                                                                    {261,
                                                                        fun(Field@0) -> {too_many_logical_sessions, Field@0} end},
                                                                    {262,
                                                                        fun(Field@0) -> {exceeded_time_limit, Field@0} end},
                                                                    {263,
                                                                        fun(Field@0) -> {operation_not_supported_in_transaction, Field@0} end},
                                                                    {264,
                                                                        fun(Field@0) -> {too_many_files_open, Field@0} end},
                                                                    {265,
                                                                        fun(Field@0) -> {orphaned_range_clean_up_failed, Field@0} end},
                                                                    {266,
                                                                        fun(Field@0) -> {fail_point_set_failed, Field@0} end},
                                                                    {267,
                                                                        fun(Field@0) -> {prepared_transaction_in_progress, Field@0} end},
                                                                    {268,
                                                                        fun(Field@0) -> {cannot_backup, Field@0} end},
                                                                    {269,
                                                                        fun(Field@0) -> {data_modified_by_repair, Field@0} end},
                                                                    {270,
                                                                        fun(Field@0) -> {repaired_replica_set_node, Field@0} end},
                                                                    {271,
                                                                        fun(Field@0) -> {js_interpreter_failure_with_stack, Field@0} end},
                                                                    {272,
                                                                        fun(Field@0) -> {migration_conflict, Field@0} end},
                                                                    {273,
                                                                        fun(Field@0) -> {producer_consumer_queue_producer_queue_depth_exceeded, Field@0} end},
                                                                    {274,
                                                                        fun(Field@0) -> {producer_consumer_queue_consumed, Field@0} end},
                                                                    {275,
                                                                        fun(Field@0) -> {exchange_passthrough, Field@0} end},
                                                                    {276,
                                                                        fun(Field@0) -> {index_build_aborted, Field@0} end},
                                                                    {277,
                                                                        fun(Field@0) -> {alarm_already_fulfilled, Field@0} end},
                                                                    {278,
                                                                        fun(Field@0) -> {unsatisfiable_commit_quorum, Field@0} end},
                                                                    {279,
                                                                        fun(Field@0) -> {client_disconnect, Field@0} end},
                                                                    {280,
                                                                        fun(Field@0) -> {change_stream_fatal_error, Field@0} end},
                                                                    {281,
                                                                        fun(Field@0) -> {transaction_coordinator_stepping_down, Field@0} end},
                                                                    {282,
                                                                        fun(Field@0) -> {transaction_coordinator_reached_abort_decision, Field@0} end},
                                                                    {283,
                                                                        fun(Field@0) -> {would_change_owning_shard, Field@0} end},
                                                                    {284,
                                                                        fun(Field@0) -> {for_testing_error_extra_info_with_extra_info_in_namespace, Field@0} end},
                                                                    {285,
                                                                        fun(Field@0) -> {index_build_already_in_progress, Field@0} end},
                                                                    {286,
                                                                        fun(Field@0) -> {change_stream_history_lost, Field@0} end},
                                                                    {287,
                                                                        fun(Field@0) -> {transaction_coordinator_deadline_task_canceled, Field@0} end},
                                                                    {288,
                                                                        fun(Field@0) -> {checksum_mismatch, Field@0} end},
                                                                    {289,
                                                                        fun(Field@0) -> {wait_for_majority_service_earlier_op_time_available, Field@0} end},
                                                                    {290,
                                                                        fun(Field@0) -> {transaction_exceeded_lifetime_limit_seconds, Field@0} end},
                                                                    {291,
                                                                        fun(Field@0) -> {no_query_execution_plans, Field@0} end},
                                                                    {292,
                                                                        fun(Field@0) -> {query_exceeded_memory_limit_no_disk_use_allowed, Field@0} end},
                                                                    {293,
                                                                        fun(Field@0) -> {invalid_seed_list, Field@0} end},
                                                                    {294,
                                                                        fun(Field@0) -> {invalid_topology_type, Field@0} end},
                                                                    {295,
                                                                        fun(Field@0) -> {invalid_heart_beat_frequency, Field@0} end},
                                                                    {296,
                                                                        fun(Field@0) -> {topology_set_name_required, Field@0} end},
                                                                    {297,
                                                                        fun(Field@0) -> {hierarchical_acquisition_level_violation, Field@0} end},
                                                                    {298,
                                                                        fun(Field@0) -> {invalid_server_type, Field@0} end},
                                                                    {299,
                                                                        fun(Field@0) -> {ocsp_certificate_status_revoked, Field@0} end},
                                                                    {300,
                                                                        fun(Field@0) -> {range_deletion_abandoned_because_collection_with_uuid_does_not_exist, Field@0} end},
                                                                    {301,
                                                                        fun(Field@0) -> {data_corruption_detected, Field@0} end},
                                                                    {302,
                                                                        fun(Field@0) -> {ocsp_certificate_status_unknown, Field@0} end},
                                                                    {303,
                                                                        fun(Field@0) -> {split_horizon_change, Field@0} end},
                                                                    {304,
                                                                        fun(Field@0) -> {shard_invalidated_for_targeting, Field@0} end},
                                                                    {306,
                                                                        fun(Field@0) -> {read_through_cache_lookup_canceled, Field@0} end},
                                                                    {307,
                                                                        fun(Field@0) -> {range_deletion_abandoned_because_task_document_does_not_exist, Field@0} end},
                                                                    {308,
                                                                        fun(Field@0) -> {current_config_not_committed_yet, Field@0} end},
                                                                    {309,
                                                                        fun(Field@0) -> {exhaust_command_finished, Field@0} end},
                                                                    {310,
                                                                        fun(Field@0) -> {periodic_job_is_stopped, Field@0} end},
                                                                    {311,
                                                                        fun(Field@0) -> {transaction_coordinator_canceled, Field@0} end},
                                                                    {312,
                                                                        fun(Field@0) -> {operation_is_killed_and_delisted, Field@0} end},
                                                                    {313,
                                                                        fun(Field@0) -> {resumable_range_deleter_disabled, Field@0} end},
                                                                    {314,
                                                                        fun(Field@0) -> {object_is_busy, Field@0} end},
                                                                    {315,
                                                                        fun(Field@0) -> {too_stale_to_sync_from_source, Field@0} end},
                                                                    {316,
                                                                        fun(Field@0) -> {query_trial_run_completed, Field@0} end},
                                                                    {317,
                                                                        fun(Field@0) -> {connection_pool_expired, Field@0} end},
                                                                    {318,
                                                                        fun(Field@0) -> {for_testing_optional_error_extra_info, Field@0} end},
                                                                    {319,
                                                                        fun(Field@0) -> {move_primary_in_progress, Field@0} end},
                                                                    {320,
                                                                        fun(Field@0) -> {tenant_migration_conflict, Field@0} end},
                                                                    {321,
                                                                        fun(Field@0) -> {tenant_migration_committed, Field@0} end},
                                                                    {322,
                                                                        fun(Field@0) -> {api_version_error, Field@0} end},
                                                                    {323,
                                                                        fun(Field@0) -> {api_strict_error, Field@0} end},
                                                                    {324,
                                                                        fun(Field@0) -> {api_deprecation_error, Field@0} end},
                                                                    {325,
                                                                        fun(Field@0) -> {tenant_migration_aborted, Field@0} end},
                                                                    {326,
                                                                        fun(Field@0) -> {oplog_query_min_ts_missing, Field@0} end},
                                                                    {327,
                                                                        fun(Field@0) -> {no_such_tenant_migration, Field@0} end},
                                                                    {328,
                                                                        fun(Field@0) -> {tenant_migration_access_blocker_shutting_down, Field@0} end},
                                                                    {329,
                                                                        fun(Field@0) -> {tenant_migration_in_progress, Field@0} end},
                                                                    {330,
                                                                        fun(Field@0) -> {skip_command_execution, Field@0} end},
                                                                    {331,
                                                                        fun(Field@0) -> {failed_to_run_with_reply_builder, Field@0} end},
                                                                    {332,
                                                                        fun(Field@0) -> {cannot_downgrade, Field@0} end},
                                                                    {333,
                                                                        fun(Field@0) -> {service_executor_in_shutdown, Field@0} end},
                                                                    {334,
                                                                        fun(Field@0) -> {mechanism_unavailable, Field@0} end},
                                                                    {335,
                                                                        fun(Field@0) -> {tenant_migration_forgotten, Field@0} end},
                                                                    {9001,
                                                                        fun(Field@0) -> {socket_exception, Field@0} end},
                                                                    {10003,
                                                                        fun(Field@0) -> {cannot_grow_document_in_capped_namespace, Field@0} end},
                                                                    {10107,
                                                                        fun(Field@0) -> {not_writable_primary, Field@0} end},
                                                                    {10334,
                                                                        fun(Field@0) -> {bson_object_too_large, Field@0} end},
                                                                    {11000,
                                                                        fun(Field@0) -> {duplicate_key, Field@0} end},
                                                                    {11600,
                                                                        fun(Field@0) -> {interrupted_at_shutdown, Field@0} end},
                                                                    {11601,
                                                                        fun(Field@0) -> {interrupted, Field@0} end},
                                                                    {11602,
                                                                        fun(Field@0) -> {interrupted_due_to_repl_state_change, Field@0} end},
                                                                    {12586,
                                                                        fun(Field@0) -> {background_operation_in_progress_for_database, Field@0} end},
                                                                    {12587,
                                                                        fun(Field@0) -> {background_operation_in_progress_for_namespace, Field@0} end},
                                                                    {13113,
                                                                        fun(Field@0) -> {merge_stage_no_matching_document, Field@0} end},
                                                                    {13297,
                                                                        fun(Field@0) -> {database_differ_case, Field@0} end},
                                                                    {13388,
                                                                        fun(Field@0) -> {stale_config, Field@0} end},
                                                                    {13435,
                                                                        fun(Field@0) -> {not_primary_no_secondary_ok, Field@0} end},
                                                                    {13436,
                                                                        fun(Field@0) -> {not_primary_or_secondary, Field@0} end},
                                                                    {14031,
                                                                        fun(Field@0) -> {out_of_disk_space, Field@0} end},
                                                                    {46841,
                                                                        fun(Field@0) -> {client_marked_killed, Field@0} end}],
                                                                Code@2
                                                            ),
                                                            {ok, Error@4} = case _assert_subject@4 of
                                                                {ok, _} -> _assert_subject@4;
                                                                _assert_fail@4 ->
                                                                    erlang:error(
                                                                            #{gleam_error => let_assert,
                                                                                message => <<"Assertion pattern match failed"/utf8>>,
                                                                                value => _assert_fail@4,
                                                                                module => <<"mungo/client"/utf8>>,
                                                                                function => <<"execute"/utf8>>,
                                                                                line => 205}
                                                                        )
                                                            end,
                                                            {error,
                                                                {server_error,
                                                                    Error@4(
                                                                        Msg@2
                                                                    )}};

                                                        {_, _, _} ->
                                                            {ok,
                                                                {Reply@2,
                                                                    Client}}
                                                    end;

                                                {error, Error@5} ->
                                                    {error, Error@5}
                                            end
                                    end;

                                false ->
                                    {error, {server_error, Error@1}}
                            end;

                        {_, _, _} ->
                            {ok, {Reply, Client}}
                    end;

                {error, Error@6} ->
                    {error, Error@6}
            end
    end.

-spec authenticate(mug:socket(), binary(), binary(), binary(), integer()) -> {ok,
        nil} |
    {error, mungo@error:error()}.
authenticate(Socket, Username, Password, Auth_source, Timeout) ->
    First_payload = mungo@scram:first_payload(Username),
    First = mungo@scram:first_message(First_payload),
    gleam@result:then(
        send_cmd(Socket, Auth_source, First, Timeout),
        fun(Reply) ->
            gleam@result:then(
                mungo@scram:parse_first_reply(Reply),
                fun(_use0) ->
                    {Server_params, Server_payload, Cid} = _use0,
                    gleam@result:then(
                        mungo@scram:second_message(
                            Server_params,
                            First_payload,
                            Server_payload,
                            Cid,
                            Password
                        ),
                        fun(_use0@1) ->
                            {Second, Server_signature} = _use0@1,
                            gleam@result:then(
                                send_cmd(Socket, Auth_source, Second, Timeout),
                                fun(Reply@1) ->
                                    case gleam@dict:get(Reply@1, <<"ok"/utf8>>) of
                                        {ok, {double, +0.0}} ->
                                            {error,
                                                {server_error,
                                                    {authentication_failed,
                                                        <<"Authentication not ok"/utf8>>}}};

                                        _ ->
                                            mungo@scram:parse_second_reply(
                                                Reply@1,
                                                Server_signature
                                            )
                                    end
                                end
                            )
                        end
                    )
                end
            )
        end
    ).

-spec parse_connection_string(binary()) -> {ok,
        {gleam@option:option({binary(), binary(), binary()}),
            list({binary(), integer()}),
            binary()}} |
    {error, mungo@error:error()}.
parse_connection_string(Uri) ->
    gleam@bool:guard(
        not gleam@string:starts_with(Uri, <<"mongodb://"/utf8>>),
        {error, connection_string_error},
        fun() ->
            Uri@1 = gleam@string:drop_left(Uri, 10),
            gleam@result:then(
                case gleam@string:split_once(Uri@1, <<"@"/utf8>>) of
                    {ok, {Auth, Rest}} ->
                        case gleam@string:split_once(Auth, <<":"/utf8>>) of
                            {ok, {Username, Password}} when (Username =/= <<""/utf8>>) andalso (Password =/= <<""/utf8>>) ->
                                case begin
                                    _pipe = [Username, Password],
                                    gleam@list:map(
                                        _pipe,
                                        fun gleam@uri:percent_decode/1
                                    )
                                end of
                                    [{ok, Username@1}, {ok, Password@1}] ->
                                        {ok,
                                            {{some, {Username@1, Password@1}},
                                                Rest}};

                                    _ ->
                                        {error, connection_string_error}
                                end;

                            _ ->
                                {error, connection_string_error}
                        end;

                    {error, nil} ->
                        {ok, {none, Uri@1}}
                end,
                fun(_use0) ->
                    {Auth@1, Rest@1} = _use0,
                    gleam@result:then(
                        begin
                            _pipe@1 = gleam@string:split_once(
                                Rest@1,
                                <<"/"/utf8>>
                            ),
                            gleam@result:replace_error(
                                _pipe@1,
                                connection_string_error
                            )
                        end,
                        fun(_use0@1) ->
                            {Hosts, Db_and_options} = _use0@1,
                            gleam@result:then(
                                begin
                                    _pipe@2 = Hosts,
                                    _pipe@3 = gleam@string:split(
                                        _pipe@2,
                                        <<","/utf8>>
                                    ),
                                    _pipe@4 = gleam@list:map(
                                        _pipe@3,
                                        fun(Host) ->
                                            case gleam@string:starts_with(
                                                Host,
                                                <<":"/utf8>>
                                            ) of
                                                true ->
                                                    {error,
                                                        connection_string_error};

                                                false ->
                                                    {ok, Host}
                                            end
                                        end
                                    ),
                                    gleam@list:try_map(
                                        _pipe@4,
                                        fun(Host@1) -> _pipe@5 = Host@1,
                                            _pipe@7 = gleam@result:map(
                                                _pipe@5,
                                                fun(Host@2) ->
                                                    case gleam@string:split_once(
                                                        Host@2,
                                                        <<":"/utf8>>
                                                    ) of
                                                        {ok, {Host@3, Port}} ->
                                                            gleam@result:then(
                                                                begin
                                                                    _pipe@6 = gleam@int:parse(
                                                                        Port
                                                                    ),
                                                                    gleam@result:replace_error(
                                                                        _pipe@6,
                                                                        connection_string_error
                                                                    )
                                                                end,
                                                                fun(Port@1) ->
                                                                    {ok,
                                                                        {Host@3,
                                                                            Port@1}}
                                                                end
                                                            );

                                                        {error, nil} ->
                                                            {ok,
                                                                {Host@2, 27017}}
                                                    end
                                                end
                                            ),
                                            gleam@result:flatten(_pipe@7) end
                                    )
                                end,
                                fun(Hosts@1) ->
                                    case gleam@string:split(
                                        Db_and_options,
                                        <<"?"/utf8>>
                                    ) of
                                        [Db] when Db =/= <<""/utf8>> ->
                                            gleam@result:then(
                                                begin
                                                    _pipe@8 = gleam@uri:percent_decode(
                                                        Db
                                                    ),
                                                    gleam@result:replace_error(
                                                        _pipe@8,
                                                        connection_string_error
                                                    )
                                                end,
                                                fun(Db@1) ->
                                                    {ok,
                                                        {begin
                                                                _pipe@9 = Auth@1,
                                                                gleam@option:map(
                                                                    _pipe@9,
                                                                    fun(Auth@2) ->
                                                                        {erlang:element(
                                                                                1,
                                                                                Auth@2
                                                                            ),
                                                                            erlang:element(
                                                                                2,
                                                                                Auth@2
                                                                            ),
                                                                            Db@1}
                                                                    end
                                                                )
                                                            end,
                                                            Hosts@1,
                                                            Db@1}}
                                                end
                                            );

                                        [Db@2,
                                            <<"authSource="/utf8, Auth_source/binary>>] when Db@2 =/= <<""/utf8>> ->
                                            gleam@result:then(
                                                begin
                                                    _pipe@10 = gleam@uri:percent_decode(
                                                        Db@2
                                                    ),
                                                    gleam@result:replace_error(
                                                        _pipe@10,
                                                        connection_string_error
                                                    )
                                                end,
                                                fun(Db@3) ->
                                                    {ok,
                                                        {begin
                                                                _pipe@11 = Auth@1,
                                                                gleam@option:map(
                                                                    _pipe@11,
                                                                    fun(Auth@3) ->
                                                                        {erlang:element(
                                                                                1,
                                                                                Auth@3
                                                                            ),
                                                                            erlang:element(
                                                                                2,
                                                                                Auth@3
                                                                            ),
                                                                            Auth_source}
                                                                    end
                                                                )
                                                            end,
                                                            Hosts@1,
                                                            Db@3}}
                                                end
                                            );

                                        _ ->
                                            {error, connection_string_error}
                                    end
                                end
                            )
                        end
                    )
                end
            )
        end
    ).

-spec connect(binary(), integer()) -> {ok, client()} |
    {error, mungo@error:error()}.
connect(Uri, Timeout) ->
    gleam@result:then(parse_connection_string(Uri), fun(Info) -> case Info of
                {Auth, Hosts, Db} ->
                    gleam@result:then(
                        gleam@list:try_map(
                            Hosts,
                            fun(Host) ->
                                gleam@result:then(
                                    begin
                                        _pipe = mungo@tcp:connect(
                                            erlang:element(1, Host),
                                            erlang:element(2, Host),
                                            Timeout
                                        ),
                                        gleam@result:map_error(
                                            _pipe,
                                            fun(Error) -> {tcp_error, Error} end
                                        )
                                    end,
                                    fun(Socket) ->
                                        gleam@result:then(
                                            is_primary(Socket, Db, Timeout),
                                            fun(Is_primary) ->
                                                {ok,
                                                    {connection,
                                                        Socket,
                                                        Is_primary}}
                                            end
                                        )
                                    end
                                )
                            end
                        ),
                        fun(Connections) -> case Auth of
                                none ->
                                    {ok, {client, Db, Connections}};

                                {some, {Username, Password, Auth_source}} ->
                                    _pipe@1 = gleam@list:try_each(
                                        gleam@list:map(
                                            Connections,
                                            fun(Connection) ->
                                                erlang:element(2, Connection)
                                            end
                                        ),
                                        fun(_capture) ->
                                            authenticate(
                                                _capture,
                                                Username,
                                                Password,
                                                Auth_source,
                                                Timeout
                                            )
                                        end
                                    ),
                                    gleam@result:replace(
                                        _pipe@1,
                                        {client, Db, Connections}
                                    )
                            end end
                    )
            end end).

-spec start(binary(), integer()) -> {ok,
        gleam@erlang@process:subject(message())} |
    {error, gleam@otp@actor:start_error()}.
start(Uri, Timeout) ->
    gleam@otp@actor:start_spec({spec, fun() -> case connect(Uri, Timeout) of
                    {ok, Client} ->
                        {ready, Client, gleam_erlang_ffi:new_selector()};

                    {error, Error} ->
                        case Error of
                            connection_string_error ->
                                {failed, <<"Invalid connection string"/utf8>>};

                            {tcp_error, _} ->
                                {failed, <<"TCP connection error"/utf8>>};

                            {server_error, {authentication_failed, Error@1}} ->
                                {failed, Error@1};

                            _ ->
                                {failed, <<"Unknown error"/utf8>>}
                        end
                end end, Timeout, fun(Msg, Client@1) -> case Msg of
                    {command, Cmd, Reply_with} ->
                        case execute(Client@1, Cmd, Timeout) of
                            {ok, {Reply, Client@2}} ->
                                gleam@otp@actor:send(Reply_with, {ok, Reply}),
                                gleam@otp@actor:continue(Client@2);

                            {error, Error@2} ->
                                gleam@otp@actor:send(
                                    Reply_with,
                                    {error, Error@2}
                                ),
                                gleam@otp@actor:continue(Client@1)
                        end;

                    {get_timeout, Reply_with@1} ->
                        gleam@otp@actor:send(Reply_with@1, Timeout),
                        gleam@otp@actor:continue(Client@1);

                    shutdown ->
                        {stop, normal}
                end end}).
